import{d as D,r as s,n as L,o as u,c as O,y as Q,u as i,q as d,w as t,x as c,a3 as z,f as e,F as V,z as j,a as A,P as G,I as H,l as J,m as X,E as Z,M as $}from"./index-DPENBzsb.js";import{g as K,_ as Y}from"./index-D9VBT2CA.js";import{u as ii}from"./tagsView-uxrzGHKp.js";import{g as ei}from"./index-D0zCJsCp.js";import{_ as ai}from"./BusinessDetailsHeader.vue_vue_type_script_setup_true_lang-BBgBg0Ls.js";import{_ as ti}from"./BusinessDetailsInfo.vue_vue_type_script_setup_true_lang-BFZFi1o8.js";import{_ as ri}from"./PermissionList.vue_vue_type_script_setup_true_lang-Ch3d1W7H.js";import{B as m}from"./index-Cb-L5Bqt.js";import{_ as si}from"./BusinessForm.vue_vue_type_script_setup_true_lang-aTUZuI7c.js";import{_ as oi}from"./TransferForm.vue_vue_type_script_setup_true_lang-BQHZ7ctl.js";import{_ as li}from"./index.vue_vue_type_script_setup_true_lang-BVFvTCKz.js";import{_ as mi}from"./ContactList.vue_vue_type_script_setup_true_lang-C4AvW2JP.js";import{_ as ui}from"./BusinessUpdateStatusForm.vue_vue_type_script_setup_true_lang-lkI1NUng.js";import{_ as pi}from"./ContractList.vue_vue_type_script_setup_true_lang-CYqttL5k.js";import{_ as ni}from"./BusinessProductList.vue_vue_type_script_setup_true_lang-BLVmf9g9.js";import"./el-timeline-item-DOhCPhED.js";import"./formatTime-C7TQtsxQ.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import"./el-descriptions-item-BD45d2S6.js";import"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import"./color-DXkOL5Tu.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-DymHMb9s.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./index-Co9HWb9O.js";import"./index-Cj_ALIC1.js";import"./index-OU-fIsLR.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-z3hq65Lx.js";import"./index-B6l7NQIx.js";import"./index-DvyG3vlo.js";import"./index-zBhacYdK.js";import"./index-BRgO_Nxc.js";import"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import"./index-C2tU_CDa.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DooL9HAc.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-B4zmNLSs.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-Cw7cyvrf.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-B4bxVlIN.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-BDJxp_NS.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CDIYsxb8.js";import"./index-gTb5e5TR.js";import"./tree-Cts6wVCK.js";import"./ContractForm.vue_vue_type_script_setup_true_lang-CnyZ7o7h.js";import"./ContractProductForm.vue_vue_type_script_setup_true_lang-BE66Fj5y.js";const di=D({name:"CrmBusinessDetail",__name:"index",setup(fi){const U=j(),p=s(0),f=s(!0),a=s({}),n=s(),b=async()=>{f.value=!0;try{a.value=await ei(p.value),await g(p.value)}finally{f.value=!1}},S=s(),v=s(),R=s(),N=()=>{var l;(l=R.value)==null||l.open(a.value.id)},k=s([]),g=async l=>{if(!l)return;const r=await K({bizType:m.CRM_BUSINESS,bizId:l});k.value=r.list},{delView:x}=ii(),{currentRoute:F}=A(),_=()=>{x(i(F))},{params:C}=G();return L(async()=>{if(!C.id)return U.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u5546\u673A\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void _();p.value=C.id,await b()}),(l,r)=>{const y=H,o=J,P=Y,T=X,W=Z,h=$;return u(),O(V,null,[Q((u(),d(ai,{business:i(a)},{default:t(()=>{var w,I,B;return[(w=i(n))!=null&&w.validateWrite?(u(),d(y,{key:0,onClick:r[0]||(r[0]=q=>{return E="update",M=i(a).id,void S.value.open(E,M);var E,M})},{default:t(()=>r[2]||(r[2]=[c(" \u7F16\u8F91 ")])),_:1})):z("",!0),(I=i(n))!=null&&I.validateWrite?(u(),d(y,{key:1,disabled:i(a).endStatus,type:"success",onClick:r[1]||(r[1]=q=>{v.value.open(a.value)})},{default:t(()=>r[3]||(r[3]=[c(" \u53D8\u66F4\u5546\u673A\u72B6\u6001 ")])),_:1},8,["disabled"])):z("",!0),(B=i(n))!=null&&B.validateOwnerUser?(u(),d(y,{key:2,type:"primary",onClick:N},{default:t(()=>r[4]||(r[4]=[c(" \u8F6C\u79FB ")])),_:1})):z("",!0)]}),_:1},8,["business"])),[[h,i(f)]]),e(W,null,{default:t(()=>[e(T,null,{default:t(()=>[e(o,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:t(()=>[e(li,{"biz-id":i(p),"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:t(()=>[e(ti,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u8054\u7CFB\u4EBA",lazy:""},{default:t(()=>[e(mi,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"business-id":i(a).id,"customer-id":i(a).customerId},null,8,["biz-id","biz-type","business-id","customer-id"])]),_:1}),e(o,{label:"\u4EA7\u54C1"},{default:t(()=>[e(ni,{business:i(a)},null,8,["business"])]),_:1}),e(o,{label:"\u5408\u540C",lazy:""},{default:t(()=>[e(pi,{"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS},null,8,["biz-id","biz-type"])]),_:1}),e(o,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:t(()=>[e(P,{"log-list":i(k)},null,8,["log-list"])]),_:1}),e(o,{label:"\u56E2\u961F\u6210\u5458"},{default:t(()=>[e(ri,{ref_key:"permissionListRef",ref:n,"biz-id":i(a).id,"biz-type":i(m).CRM_BUSINESS,"show-action":!0,onQuitTeam:_},null,8,["biz-id","biz-type"])]),_:1})]),_:1})]),_:1}),e(si,{ref_key:"formRef",ref:S,onSuccess:b},null,512),e(ui,{ref_key:"statusFormRef",ref:v,onSuccess:b},null,512),e(oi,{ref_key:"transferFormRef",ref:R,"biz-type":i(m).CRM_BUSINESS,onSuccess:_},null,8,["biz-type"])],64)}}});export{di as default};
