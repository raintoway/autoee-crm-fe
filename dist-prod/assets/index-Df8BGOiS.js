import{d as X,f as a,H as d,D as V,bS as Y,x as o,I as i,F as b,e8 as Z,h as $,z as ee,r,e as ae,n as le,U as te,o as y,c as O,w as s,u as t,N as se,p as ne,O as oe,q as F,y as ie,k as re,e9 as M,T as ue,C as de,A as me,B as ce,J as pe}from"./index-DPENBzsb.js";import"./el-empty-uLszESQ-.js";import"./el-virtual-list-DJUlHzXl.js";import{F as R,E as ye,a as fe}from"./el-table-v2-Bgvgn-gy.js";import{_ as he}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{_ as ke}from"./index-CbaPuDB3.js";import{h as we}from"./tree-Cts6wVCK.js";import{d as ve,u as _e,b as xe}from"./index-BVRKhr7s.js";import{_ as Ce}from"./MenuForm.vue_vue_type_script_setup_true_lang-CEdLkbxi.js";import{_ as be}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{c as f}from"./permission-CaCuVwEz.js";import{C as N}from"./constants-C8tGWvl2.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./Tooltip.vue_vue_type_script_setup_true_lang-DdTZzcyA.js";import"./index-C2tU_CDa.js";import"./el-tree-select-DxCa0FGQ.js";import"./color-DXkOL5Tu.js";const Re=X({name:"SystemMenu",__name:"index",setup(Se){const S=[{key:"name",title:"\u83DC\u5355\u540D\u79F0",dataKey:"name",width:250,fixed:R.LEFT},{key:"icon",title:"\u56FE\u6807",dataKey:"icon",width:100,align:"center",cellRenderer:({cellData:l})=>a(d,{icon:l},null)},{key:"sort",title:"\u6392\u5E8F",dataKey:"sort",width:60},{key:"permission",title:"\u6743\u9650\u6807\u8BC6",dataKey:"permission",width:300},{key:"component",title:"\u7EC4\u4EF6\u8DEF\u5F84",dataKey:"component",width:500},{key:"componentName",title:"\u7EC4\u4EF6\u540D\u79F0",dataKey:"componentName",width:200},{key:"status",title:"\u72B6\u6001",dataKey:"status",width:60,fixed:R.RIGHT,cellRenderer:({rowData:l})=>f(["system:menu:update"])?a(Y,{modelValue:l.status,"onUpdate:modelValue":e=>l.status=e,"active-value":N.ENABLE,"inactive-value":N.DISABLE,loading:x[l.id],class:"ml-4px",onChange:e=>G(l,e)},null):a(be,{type:V.COMMON_STATUS,value:l.status},null)},{key:"operations",title:"\u64CD\u4F5C",align:"center",width:160,fixed:R.RIGHT,cellRenderer:({rowData:l})=>{const e=[];return f(["system:menu:update"])&&e.push(a(i,{key:"edit",link:!0,type:"primary",onClick:()=>_("update",l.id)},{default:()=>[o("\u4FEE\u6539")]})),f(["system:menu:create"])&&e.push(a(i,{key:"create",link:!0,type:"primary",onClick:()=>_("create",void 0,l.id)},{default:()=>[o("\u65B0\u589E")]})),f(["system:menu:delete"])&&e.push(a(i,{key:"delete",link:!0,type:"danger",onClick:()=>B(l.id)},{default:()=>[o("\u5220\u9664")]})),e.length===0?null:a(b,null,[e])}}],{wsCache:E}=Z(),{t:A}=$(),h=ee(),K=r(!0),k=r([]),u=ae({name:void 0,status:void 0}),T=r(),w=r(!1);r(!0);const m=r([]),c=async()=>{K.value=!0;try{const l=await xe(u);k.value=we(l)}finally{K.value=!1}},v=()=>{c()},D=()=>{T.value.resetFields(),v()},U=r(),_=(l,e,p)=>{U.value.open(l,e,p)},I=()=>{w.value?m.value=[]:m.value=k.value.map(l=>l.id),w.value=!w.value},L=async()=>{try{await h.confirm("\u5373\u5C06\u66F4\u65B0\u7F13\u5B58\u5237\u65B0\u6D4F\u89C8\u5668\uFF01","\u5237\u65B0\u83DC\u5355\u7F13\u5B58"),E.delete(M.USER),E.delete(M.ROLE_ROUTERS),location.reload()}catch{}},B=async l=>{try{await h.delConfirm(),await ve(l),h.success(A("common.delSuccess")),await c()}catch{}},x=r({}),G=async(l,e)=>{x.value[l.id]=!0;try{l.status=e,await _e(l)}finally{x.value[l.id]=!1}};return le(()=>{c()}),(l,e)=>{const p=ke,H=ue,C=de,q=me,z=ce,J=pe,g=he,P=ye,j=fe,Q=te("hasPermi");return y(),O(b,null,[a(p,{title:"\u529F\u80FD\u6743\u9650",url:"https://doc.iocoder.cn/resource-permission"}),a(p,{title:"\u83DC\u5355\u8DEF\u7531",url:"https://doc.iocoder.cn/vue3/route/"}),a(g,null,{default:s(()=>[a(J,{ref_key:"queryFormRef",ref:T,inline:!0,model:t(u),class:"-mb-15px","label-width":"68px"},{default:s(()=>[a(C,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:s(()=>[a(H,{modelValue:t(u).name,"onUpdate:modelValue":e[0]||(e[0]=n=>t(u).name=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",onKeyup:se(v,["enter"])},null,8,["modelValue"])]),_:1}),a(C,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[a(z,{modelValue:t(u).status,"onUpdate:modelValue":e[1]||(e[1]=n=>t(u).status=n),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355\u72B6\u6001"},{default:s(()=>[(y(!0),O(b,null,ne(t(oe)(t(V).COMMON_STATUS),n=>(y(),F(q,{key:n.value,label:n.label,value:n.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(C,null,{default:s(()=>[a(t(i),{onClick:v},{default:s(()=>[a(t(d),{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=o(" \u641C\u7D22 "))]),_:1}),a(t(i),{onClick:D},{default:s(()=>[a(t(d),{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=o(" \u91CD\u7F6E "))]),_:1}),ie((y(),F(t(i),{plain:"",type:"primary",onClick:e[2]||(e[2]=n=>_("create"))},{default:s(()=>[a(t(d),{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=o(" \u65B0\u589E "))]),_:1})),[[Q,["system:menu:create"]]]),a(t(i),{plain:"",type:"danger",onClick:I},{default:s(()=>[a(t(d),{class:"mr-5px",icon:"ep:sort"}),e[7]||(e[7]=o(" \u5C55\u5F00/\u6298\u53E0 "))]),_:1}),a(t(i),{plain:"",onClick:L},{default:s(()=>[a(t(d),{class:"mr-5px",icon:"ep:refresh"}),e[8]||(e[8]=o(" \u5237\u65B0\u83DC\u5355\u7F13\u5B58 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(g,null,{default:s(()=>[a(j,null,{default:s(({width:n})=>[a(P,{"expanded-row-keys":t(m),"onUpdate:expandedRowKeys":e[3]||(e[3]=W=>re(m)?m.value=W:null),columns:S,data:t(k),"expand-column-key":S[0].key,height:1e3,width:n,fixed:"","row-key":"id"},null,8,["expanded-row-keys","data","expand-column-key","width"])]),_:1})]),_:1}),a(Ce,{ref_key:"formRef",ref:U,onSuccess:c},null,512)],64)}}});export{Re as default};
