import{dN as te,dO as re,dP as se,dQ as ie,d as le,P as ne,z as ce,r as v,a1 as H,n as pe,u as p,o as s,c as h,f as k,w as u,k as fe,y as ue,q as I,g as $,F as E,p as q,W as M,t as O,dI as me,x as de,am as ve,H as ye,T as xe,E as ge,d1 as he,j as ke,aY as be,ap as _e,i as we,M as Ce,bk as Ie,_ as Pe}from"./index-DPENBzsb.js";import{_ as Te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{E as $e}from"./el-empty-uLszESQ-.js";import{E as ze}from"./el-image-DqGFoayu.js";import{b as De}from"./index-B9xqy6_R.js";import{f as Ee}from"./index-DetSWMsK.js";import{C as Oe}from"./index-C_gZe85y.js";import Ve from"./ProcessDefinitionDetail-DyhaULxa.js";import"./formCreate-BQ5MeUYD.js";import"./constants-C8tGWvl2.js";import"./consts-Dqfik1EE.js";import"./ProcessInstanceBpmnViewer-DhragUyT.js";import"./bpmn-embedded-BBruoZr8.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./XTextButton-CaCskr4h.js";import"./XButton-lfojvuGT.js";import"./index-Co9HWb9O.js";import"./utils-CjFsbWby.js";import"./index-D2cLVQ1T.js";import"./index-BCN8BzfC.js";import"./index-BOzeB1Pk.js";import"./el-tree-select-DxCa0FGQ.js";import"./tree-Cts6wVCK.js";import"./index-tb7T-AVj.js";import"./index-BUzABQZW.js";import"./index-Btz8nVwe.js";import"./index-BAEJzc7Z.js";import"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import"./index-C2tU_CDa.js";import"./index-O66V04DS.js";import"./el-drawer-DSddsvoD.js";import"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import"./color-DXkOL5Tu.js";import"./index-IbQXwv2T.js";import"./formatTime-C7TQtsxQ.js";import"./ProcessInstanceSimpleViewer.vue_vue_type_script_setup_true_lang-7iwin6s7.js";import"./simple-process-designer-RJplQ98g.js";import"./el-space-B67e9bQY.js";import"./download-oWiM5xVU.js";import"./ProcessInstanceTimeline.vue_vue_type_script_setup_true_lang-DqnNG6nc.js";import"./index-NekN2je6.js";import"./el-timeline-item-DOhCPhED.js";import"./el-avatar-BjIHlmF4.js";import"./tagsView-uxrzGHKp.js";function je(r,i,f,m){for(var n=-1,y=r==null?0:r.length;++n<y;){var d=r[n];i(m,d,f(d),r)}return m}function qe(r,i,f,m){return te(r,function(n,y,d){i(m,n,f(n),d)}),m}var Q,Le=Object.prototype.hasOwnProperty,Se=(Q=function(r,i,f){Le.call(r,f)?r[f].push(i):ie(r,f,[i])},function(r,i){return(se(r)?je:qe)(r,Q,re(i),{})});const We={class:"flex flex-col"},Be=["onClick"],He={class:"text-18px font-bold mb-10px mt-5px"},Me={class:"grid grid-cols-3 gap3"},Qe={class:"flex"},Ye={key:1,class:"flow-icon"},Ae={style:{"font-size":"12px",color:"#fff"}},Fe=Pe(le({name:"BpmProcessInstanceCreate",__name:"index",setup(r){const{proxy:i}=Ie(),f=ne(),m=ce(),n=v(""),y=f.query.processInstanceId,d=v(!0),x=v([]),b=v({}),_=v([]),Y=async()=>{try{x.value=await Oe.getCategorySimpleList()}finally{}},A=async()=>{var e;try{_.value=await De({suspensionState:1}),w.value=_.value,j.value.length>0&&!((e=b.value)!=null&&e.code)&&(b.value=j.value[0])}finally{}},w=v([]),L=()=>{n.value.trim()?w.value=_.value.filter(e=>e.name.toLowerCase().includes(n.value.toLowerCase())):w.value=_.value},V=H(()=>{var a;if(!((a=_.value)!=null&&a.length))return{};const e=Se(w.value,"category"),o={};return x.value.forEach(t=>{e[t.code]&&(o[t.code]=e[t.code])}),o}),F=e=>{var o,a;return(a=(o=x.value)==null?void 0:o.find(t=>t.code===e))==null?void 0:a.name},z=v(),S=v(),W=async(e,o)=>{var a;z.value=e,await ve(),(a=S.value)==null||a.initProcessInfo(e,o)},J=e=>{const o=e.scrollTop,a=x.value.map(c=>{const g=i.$refs[`category-${c.code}`];return g!=null&&g[0]?{code:c.code,offsetTop:g[0].offsetTop,height:g[0].offsetHeight}:null}).filter(Boolean);let t=a[0];for(const c of a){if(!(o>=c.offsetTop-50))break;t=c}t&&b.value.code!==t.code&&(b.value=x.value.find(c=>c.code===t.code))},j=H(()=>{var o;if(!((o=x.value)!=null&&o.length)||!V.value)return[];const e=Object.keys(V.value);return x.value.filter(a=>e.includes(a.code))});return pe(()=>{(async()=>{d.value=!0;try{if(await Y(),await A(),(y==null?void 0:y.length)>0){const e=await Ee(y);if(!e)return void m.error("\u91CD\u65B0\u53D1\u8D77\u6D41\u7A0B\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A\u6D41\u7A0B\u5B9E\u4F8B\u4E0D\u5B58\u5728");const o=_.value.find(a=>{var t;return a.key==((t=e.processDefinition)==null?void 0:t.key)});if(!o)return void m.error("\u91CD\u65B0\u53D1\u8D77\u6D41\u7A0B\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A\u6D41\u7A0B\u5B9A\u4E49\u4E0D\u5B58\u5728");await W(o,e.formVariables)}}finally{d.value=!1}})()}),(e,o)=>{var B;const a=ye,t=xe,c=ge,g=ze,N=he,R=ke,U=be,X=_e,G=we,K=$e,Z=Te,ee=Ce;return p(z)?(s(),I(Ve,{key:1,ref_key:"processDefinitionDetailRef",ref:S,selectProcessDefinition:p(z),onCancel:o[1]||(o[1]=P=>z.value=void 0)},null,8,["selectProcessDefinition"])):(s(),h(E,{key:0},[k(t,{modelValue:p(n),"onUpdate:modelValue":o[0]||(o[0]=P=>fe(n)?n.value=P:null),class:"!w-50% mb-15px",placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",clearable:"",onInput:L,onClear:L},{prefix:u(()=>[k(a,{icon:"ep:search"})]),_:1},8,["modelValue"]),ue((s(),I(Z,{class:M([{"process-definition-container":(B=p(w))==null?void 0:B.length},"position-relative pb-20px h-700px"])},{default:u(()=>{var P;return[(P=p(w))!=null&&P.length?(s(),I(G,{key:0,gutter:20,class:"!flex-nowrap"},{default:u(()=>[k(c,{span:5},{default:u(()=>[$("div",We,[(s(!0),h(E,null,q(p(j),C=>(s(),h("div",{key:C.code,class:M(["flex items-center p-10px cursor-pointer text-14px rounded-md",p(b).code===C.code?"text-#3e7bff bg-#e8eeff":""]),onClick:D=>(l=>{b.value=l;const T=i.$refs[`category-${l.code}`];if(T!=null&&T.length){const oe=i.$refs.scrollWrapper,ae=T[0].offsetTop;oe.scrollTo({top:ae,behavior:"smooth"})}})(C)},O(C.name),11,Be))),128))])]),_:1}),k(c,{span:19},{default:u(()=>[k(X,{ref:"scrollWrapper",height:"700",onScroll:J},{default:u(()=>[(s(!0),h(E,null,q(p(V),(C,D)=>(s(),h("div",{class:"mb-20px pl-10px",key:D,ref_for:!0,ref:`category-${D}`},[$("h3",He,O(F(D)),1),$("div",Me,[(s(!0),h(E,null,q(C,l=>(s(),I(U,{key:l.id,content:l.description,disabled:!l.description||l.description.trim().length===0,placement:"top"},{default:u(()=>[k(R,{shadow:"hover",class:"cursor-pointer definition-item-card",onClick:T=>W(l)},{default:u(()=>[$("div",Qe,[l.icon?(s(),I(g,{key:0,src:l.icon,class:"w-32px h-32px"},null,8,["src"])):(s(),h("div",Ye,[$("span",Ae,O(p(me)(l.name,0,2)),1)])),k(N,{class:"!ml-10px",size:"large"},{default:u(()=>[de(O(l.name),1)]),_:2},1024)])]),_:2},1032,["onClick"])]),_:2},1032,["content","disabled"]))),128))])]))),128))]),_:1},512)]),_:1})]),_:1})):(s(),I(K,{key:1,class:"!py-200px","image-size":200,description:"\u6CA1\u6709\u627E\u5230\u641C\u7D22\u7ED3\u679C"}))]}),_:1},8,["class"])),[[ee,p(d)]])],64))}}}),[["__scopeId","data-v-7dc267b8"]]);export{Fe as default};
