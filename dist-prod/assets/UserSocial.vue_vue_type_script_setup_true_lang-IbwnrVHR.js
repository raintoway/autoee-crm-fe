import{a$ as d,d as R,r as f,n as S,aw as x,o as u,q as I,w as m,f as l,g as h,t as N,c as v,x as w,F as U,u as L,z as P,P as $,K as j,L as z}from"./index-DPENBzsb.js";import{_ as F}from"./XTextButton-CaCskr4h.js";import{S as g}from"./constants-C8tGWvl2.js";import{g as K}from"./profile-CIHzIAV0.js";const A=["src"],B={class:"mr-5"},D=R({name:"UserSocial",__name:"UserSocial",props:{activeName:{}},emits:["update:activeName"],setup(E,{emit:k}){const y=P(),n=f([]),r=f(),c=$(),C=k,_=()=>{const s=(e="type",new URL(decodeURIComponent(location.href)).searchParams.get(e)??"");var e;const a=c.query.code,t=c.query.state;a&&((i,o,p)=>d.post({url:"/system/social-user/bind",data:{type:i,code:o,state:p}}))(s,a,t).then(()=>{y.success("\u7ED1\u5B9A\u6210\u529F"),C("update:activeName","userSocial")})},b=s=>{const e=location.origin+"/user/profile?"+encodeURIComponent(`type=${s.type}`);((a,t)=>d.get({url:"/system/auth/social-auth-redirect?type="+a+"&redirectUri="+t}))(s.type,encodeURIComponent(e)).then(a=>{window.location.href=a})},q=async s=>{var e,a;await(e=s.type,a=s.openid,d.delete({url:"/system/social-user/unbind",data:{type:e,openid:a}}))&&(s.openid=void 0),y.success("\u89E3\u7ED1\u6210\u529F")};return S(async()=>{await(async()=>{var e;n.value=[];const s=await K();r.value=s;for(const a in g){const t={...g[a]};if(n.value.push(t),(e=r.value)==null?void 0:e.socialUsers){for(const i in r.value.socialUsers)if(t.type===r.value.socialUsers[i].type){t.openid=r.value.socialUsers[i].openid;break}}}})()}),x(()=>c,()=>{_()},{immediate:!0}),(s,e)=>{const a=j,t=F,i=z;return u(),I(i,{data:L(n),"show-header":!1},{default:m(()=>[l(a,{fixed:"left",title:"\u5E8F\u53F7",type:"seq",width:"60"}),l(a,{align:"left",label:"\u793E\u4EA4\u5E73\u53F0",width:"120"},{default:m(({row:o})=>[h("img",{src:o.img,alt:"",class:"h-5 align-middle"},null,8,A),h("p",B,N(o.title),1)]),_:1}),l(a,{align:"center",label:"\u64CD\u4F5C"},{default:m(({row:o})=>[o.openid?(u(),v(U,{key:0},[e[0]||(e[0]=w(" \u5DF2\u7ED1\u5B9A ")),l(t,{class:"mr-5",title:"(\u89E3\u7ED1)",type:"primary",onClick:p=>q(o)},null,8,["onClick"])],64)):(u(),v(U,{key:1},[e[1]||(e[1]=w(" \u672A\u7ED1\u5B9A ")),l(t,{class:"mr-5",title:"(\u7ED1\u5B9A)",type:"primary",onClick:p=>b(o)},null,8,["onClick"])],64))]),_:1})]),_:1},8,["data"])}}});export{D as _};
