import{d as $,r as s,n as q,o as m,c as B,f as e,w as i,u as a,y as D,q as f,x as d,a3 as E,F as Q,z as V,a as W,P as j,I as A,l as G,m as H,E as X,U as Z}from"./index-DPENBzsb.js";import{g as J,_ as K}from"./index-D9VBT2CA.js";import{u as N}from"./tagsView-uxrzGHKp.js";import{g as Y,t as aa}from"./index-DvyG3vlo.js";import{_ as ea}from"./ClueForm.vue_vue_type_script_setup_true_lang-BQYsVskf.js";import{_ as ia}from"./ClueDetailsHeader.vue_vue_type_script_setup_true_lang-DOywtskJ.js";import{_ as ta}from"./ClueDetailsInfo.vue_vue_type_script_setup_true_lang-BlRLQriq.js";import{_ as ra}from"./PermissionList.vue_vue_type_script_setup_true_lang-Ch3d1W7H.js";import{_ as la}from"./TransferForm.vue_vue_type_script_setup_true_lang-BQHZ7ctl.js";import{_ as oa}from"./index.vue_vue_type_script_setup_true_lang-BVFvTCKz.js";import{B as c}from"./index-Cb-L5Bqt.js";import"./el-timeline-item-DOhCPhED.js";import"./formatTime-C7TQtsxQ.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./index-gTb5e5TR.js";import"./tree-Cts6wVCK.js";import"./index-Co9HWb9O.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import"./el-descriptions-item-BD45d2S6.js";import"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import"./color-DXkOL5Tu.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-DymHMb9s.js";import"./index-D0zCJsCp.js";import"./index-zBhacYdK.js";import"./index-OU-fIsLR.js";import"./index-BRgO_Nxc.js";import"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import"./index-C2tU_CDa.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DooL9HAc.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-B4zmNLSs.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-Cw7cyvrf.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-B4bxVlIN.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-aTUZuI7c.js";import"./index-Cj_ALIC1.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-z3hq65Lx.js";import"./index-B6l7NQIx.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-BDJxp_NS.js";import"./ContactForm.vue_vue_type_script_setup_true_lang-CDIYsxb8.js";const sa=$({name:"CrmClueDetail",__name:"index",setup(ma){const l=s(0),_=s(!0),y=V(),{delView:L}=N(),{currentRoute:M}=W(),p=s(),o=s({}),v=async()=>{_.value=!0;try{o.value=await Y(l.value),await F()}finally{_.value=!1}},w=s(),x=()=>{var t;(t=w.value)==null||t.open("update",l.value)},z=s(),S=()=>{var t;(t=z.value)==null||t.open(l.value)},h=async()=>{await y.confirm(`\u786E\u5B9A\u5C06\u3010${o.value.name}\u3011\u8F6C\u5316\u4E3A\u5BA2\u6237\u5417\uFF1F`),await aa(l.value),y.success(`\u8F6C\u5316\u5BA2\u6237\u3010${o.value.name}\u3011\u6210\u529F`),await v()},C=s([]),F=async()=>{const t=await J({bizType:c.CRM_CLUE,bizId:l.value});C.value=t.list},b=()=>{L(a(M))},{params:k}=j();return q(()=>{if(!k.id)return y.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u7EBF\u7D22\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void b();l.value=k.id,v()}),(t,r)=>{const u=A,n=G,I=K,O=H,P=X,T=Z("hasPermi");return m(),B(Q,null,[e(ia,{clue:a(o),loading:a(_)},{default:i(()=>{var R,g,U;return[(R=a(p))!=null&&R.validateWrite?D((m(),f(u,{key:0,type:"primary",onClick:x},{default:i(()=>r[0]||(r[0]=[d(" \u7F16\u8F91 ")])),_:1})),[[T,["crm:clue:update"]]]):E("",!0),(g=a(p))!=null&&g.validateOwnerUser?(m(),f(u,{key:1,type:"primary",onClick:S},{default:i(()=>r[1]||(r[1]=[d(" \u8F6C\u79FB ")])),_:1})):E("",!0),(U=a(p))!=null&&U.validateOwnerUser&&!a(o).transformStatus?(m(),f(u,{key:2,type:"success",onClick:h},{default:i(()=>r[2]||(r[2]=[d(" \u8F6C\u5316\u4E3A\u5BA2\u6237 ")])),_:1})):(m(),f(u,{key:3,disabled:"",type:"success"},{default:i(()=>r[3]||(r[3]=[d("\u5DF2\u8F6C\u5316\u5BA2\u6237")])),_:1}))]}),_:1},8,["clue","loading"]),e(P,null,{default:i(()=>[e(O,null,{default:i(()=>[e(n,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[e(oa,{"biz-id":a(l),"biz-type":a(c).CRM_CLUE},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u57FA\u672C\u4FE1\u606F"},{default:i(()=>[e(ta,{clue:a(o)},null,8,["clue"])]),_:1}),e(n,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[e(ra,{ref_key:"permissionListRef",ref:p,"biz-id":a(o).id,"biz-type":a(c).CRM_CLUE,"show-action":!0,onQuitTeam:b},null,8,["biz-id","biz-type"])]),_:1}),e(n,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[e(I,{"log-list":a(C)},null,8,["log-list"])]),_:1})]),_:1})]),_:1}),e(ea,{ref_key:"formRef",ref:w,onSuccess:v},null,512),e(la,{ref_key:"transferFormRef",ref:z,"biz-type":a(c).CRM_CLUE,onSuccess:b},null,8,["biz-type"])],64)}}});export{sa as default};
