import{_ as O}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{d as A,r as u,e as P,n as R,o as h,c as _,f as l,w as s,g as z,u as a,ah as N,x as i,F as y,p as j,q as H,t as J,O as L,D as W,k as G,h as K,z as Q,a as X,P as Y,H as Z,I as $,T as ee,C as ae,ai as le,aj as se,J as te}from"./index-DPENBzsb.js";import{_ as oe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{C as re}from"./constants-C8tGWvl2.js";import{g as de,c as ue,u as ne}from"./index-BOzeB1Pk.js";import{s as ie,e as me,a as pe}from"./formCreate-BQ5MeUYD.js";import{u as fe}from"./tagsView-uxrzGHKp.js";import{u as ce}from"./useFormCreateDesigner-BoVUdKh0.js";import"./index-BCN8BzfC.js";import"./dict.type-UYIEcT9p.js";const he={class:"h-[calc(100vh-var(--top-tool-height)-var(--tags-view-height)-var(--app-content-padding)-var(--app-content-padding)-2px)]"},ge=A({name:"BpmFormEditor",__name:"index",setup(ve){const{t:g}=K(),v=Q(),{push:b,currentRoute:V}=X(),{query:C}=Y(),{delView:k}=fe(),x=u({switchType:[],autoActive:!0,useTemplate:!1,formOptions:{form:{labelWidth:"100px"}},fieldReadonly:!1,hiddenDragMenu:!1,hiddenDragBtn:!1,hiddenMenu:[],hiddenItem:[],hiddenItemConfig:{},disabledItemConfig:{},showSaveBtn:!1,showConfig:!0,showBaseForm:!0,showControl:!0,showPropsForm:!0,showEventForm:!0,showValidateForm:!0,showFormConfig:!0,showInputData:!0,showDevice:!0,appendConfigData:[]}),n=u();ce(n);const d=u(!1),m=u(!1),o=u({name:"",status:re.ENABLE,remark:""}),F=P({name:[{required:!0,message:"\u8868\u5355\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u5F00\u542F\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),p=u(),D=()=>{d.value=!0},T=async()=>{if(p&&await p.value.validate()){m.value=!0;try{const r=o.value;r.conf=me(n),r.fields=pe(n),r.id?(await ne(r),v.success(g("common.updateSuccess"))):(await ue(r),v.success(g("common.createSuccess"))),d.value=!1,U()}finally{m.value=!1}}},U=()=>{k(a(V)),b("/bpm/manager/form")};return R(async()=>{const r=C.id;if(!r)return;const e=await de(r);o.value=e,ie(n,e.conf,e.fields)}),(r,e)=>{const q=Z,f=$,B=oe,w=ee,c=ae,I=le,S=se,E=te,M=O;return h(),_(y,null,[l(B,{"body-style":{padding:"0px"},class:"!mb-0"},{default:s(()=>[z("div",he,[l(a(N),{class:"my-designer",ref_key:"designer",ref:n,config:a(x)},{handle:s(()=>[l(f,{size:"small",type:"success",plain:"",onClick:D},{default:s(()=>[l(q,{class:"mr-5px",icon:"ep:plus"}),e[5]||(e[5]=i(" \u4FDD\u5B58 "))]),_:1})]),_:1},8,["config"])])]),_:1}),l(M,{modelValue:a(d),"onUpdate:modelValue":e[4]||(e[4]=t=>G(d)?d.value=t:null),title:"\u4FDD\u5B58\u8868\u5355",width:"600"},{footer:s(()=>[l(f,{disabled:a(m),type:"primary",onClick:T},{default:s(()=>e[6]||(e[6]=[i("\u786E \u5B9A")])),_:1},8,["disabled"]),l(f,{onClick:e[3]||(e[3]=t=>d.value=!1)},{default:s(()=>e[7]||(e[7]=[i("\u53D6 \u6D88")])),_:1})]),default:s(()=>[l(E,{ref_key:"formRef",ref:p,model:a(o),rules:a(F),"label-width":"80px"},{default:s(()=>[l(c,{label:"\u8868\u5355\u540D",prop:"name"},{default:s(()=>[l(w,{modelValue:a(o).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(o).name=t),placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D"},null,8,["modelValue"])]),_:1}),l(c,{label:"\u72B6\u6001",prop:"status"},{default:s(()=>[l(S,{modelValue:a(o).status,"onUpdate:modelValue":e[1]||(e[1]=t=>a(o).status=t)},{default:s(()=>[(h(!0),_(y,null,j(a(L)(a(W).COMMON_STATUS),t=>(h(),H(I,{key:t.value,value:t.value},{default:s(()=>[i(J(t.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"\u5907\u6CE8",prop:"remark"},{default:s(()=>[l(w,{modelValue:a(o).remark,"onUpdate:modelValue":e[2]||(e[2]=t=>a(o).remark=t),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}});export{ge as default};
