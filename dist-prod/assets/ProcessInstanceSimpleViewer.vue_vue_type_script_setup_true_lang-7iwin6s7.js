import{d as E,r as l,aw as T,o as m,q as R,u,ay as v,ag as O,y as I,c as f,f as P,M as D}from"./index-DPENBzsb.js";import{T as e}from"./index-D2cLVQ1T.js";import{N as i}from"./consts-Dqfik1EE.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./el-drawer-DSddsvoD.js";import"./el-tree-select-DxCa0FGQ.js";import{_ as w}from"./simple-process-designer-RJplQ98g.js";import"./el-space-B67e9bQY.js";import{b as V}from"./utils-CjFsbWby.js";const k=E({name:"SimpleProcessViewer",__name:"SimpleProcessViewer",props:{flowNode:{type:Object,required:!0},tasks:{type:Array,default:()=>[]},processInstance:{type:Object,default:()=>{}}},setup(y){const s=y,r=l(s.tasks),d=l(s.processInstance),N=V(s);return T(()=>s.tasks,c=>{r.value=c}),T(()=>s.processInstance,c=>{d.value=c}),v("tasks",r),v("processInstance",d),(c,t)=>{const o=w;return m(),R(o,{"flow-node":u(N),readonly:!0},null,8,["flow-node"])}}}),C={class:"process-viewer-container"},b=E({name:"BpmProcessInstanceSimpleViewer",__name:"ProcessInstanceSimpleViewer",props:{loading:O.bool.def(!1),modelView:O.object,simpleJson:O.string},setup(y){const s=y,r=l({}),d=l([]),N=l();T(()=>s.modelView,async t=>{if(t){d.value=t.tasks,N.value=t.processInstance;const o=t.rejectedTaskActivityIds,n=t.unfinishedTaskActivityIds,p=t.finishedTaskActivityIds,a=t.finishedSequenceFlowActivityIds;c(t.simpleModel,t.processInstance.status,o,n,p,a),r.value=t.simpleModel}}),T(()=>s.simpleJson,async t=>{t&&(r.value=JSON.parse(t))});const c=(t,o,n,p,a,S)=>{var _;t&&(t.type!==i.END_EVENT_NODE?(t.type!==i.START_USER_NODE&&t.type!==i.USER_TASK_NODE||(t.activityStatus=e.NOT_START,n.includes(t.id)?t.activityStatus=e.REJECT:p.includes(t.id)?t.activityStatus=e.RUNNING:a.includes(t.id)&&(t.activityStatus=e.APPROVE)),t.type===i.COPY_TASK_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.DELAY_TIMER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.TRIGGER_NODE&&(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type===i.CONDITION_NODE&&(S.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START),t.type!==i.CONDITION_BRANCH_NODE&&t.type!==i.PARALLEL_BRANCH_NODE&&t.type!==i.INCLUSIVE_BRANCH_NODE&&t.type!==i.ROUTER_BRANCH_NODE||(a.includes(t.id)?t.activityStatus=e.APPROVE:t.activityStatus=e.NOT_START,(_=t.conditionNodes)==null||_.forEach(A=>{c(A,o,n,p,a,S)})),c(t.childNode,o,n,p,a,S)):a.includes(t.id)?t.activityStatus=o:t.activityStatus=e.NOT_START)};return(t,o)=>{const n=D;return I((m(),f("div",C,[P(u(k),{"flow-node":u(r),tasks:u(d),"process-instance":u(N)},null,8,["flow-node","tasks","process-instance"])])),[[n,y.loading]])}}});export{b as _};
