import{d as J,z as L,h as j,a as G,r as p,e as Q,aw as W,n as X,al as Y,U as Z,o as m,c as $,f as a,w as l,u as t,N as ee,x as u,y as c,q as f,D as ae,k as le,F as te,T as oe,C as re,H as ne,I as se,J as ie,K as pe,L as me,M as ue}from"./index-DPENBzsb.js";import{_ as de}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import{_ as fe}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{_ as ge}from"./index-CbaPuDB3.js";import{d as ye}from"./formatTime-C7TQtsxQ.js";import{b as be,d as ke,g as we}from"./index-BOzeB1Pk.js";import{b as Ce}from"./formCreate-BQ5MeUYD.js";import"./index-C2tU_CDa.js";import"./color-DXkOL5Tu.js";const he=J({name:"BpmForm",__name:"index",setup(ve){const h=L(),{t:z}=j(),{currentRoute:T,push:B}=G(),y=p(!0),v=p(0),x=p([]),r=Q({pageNo:1,pageSize:10,name:null}),N=p(),d=async()=>{y.value=!0;try{const n=await be(r);x.value=n.list,v.value=n.total}finally{y.value=!1}},b=()=>{r.pageNo=1,d()},M=()=>{N.value.resetFields(),b()},S=n=>{const e={name:"BpmFormEditor"};typeof n!="number"&&typeof n!="string"||(e.query={id:n}),B(e)},_=p(!1),k=p({rule:[],option:{}});return W(()=>T.value,()=>{d()},{immediate:!0}),X(()=>{d()}),(n,e)=>{const R=ge,A=oe,U=re,w=ne,s=se,E=ie,V=_e,i=pe,K=fe,O=me,P=ce,D=Y("form-create"),H=de,g=Z("hasPermi"),I=ue;return m(),$(te,null,[a(R,{title:"\u5BA1\u6279\u63A5\u5165\uFF08\u6D41\u7A0B\u8868\u5355\uFF09",url:"https://doc.iocoder.cn/bpm/use-bpm-form/"}),a(V,null,{default:l(()=>[a(E,{ref_key:"queryFormRef",ref:N,inline:!0,model:t(r),class:"-mb-15px","label-width":"68px"},{default:l(()=>[a(U,{label:"\u8868\u5355\u540D",prop:"name"},{default:l(()=>[a(A,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=o=>t(r).name=o),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8868\u5355\u540D",onKeyup:ee(b,["enter"])},null,8,["modelValue"])]),_:1}),a(U,null,{default:l(()=>[a(s,{onClick:b},{default:l(()=>[a(w,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=u(" \u641C\u7D22 "))]),_:1}),a(s,{onClick:M},{default:l(()=>[a(w,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=u(" \u91CD\u7F6E "))]),_:1}),c((m(),f(s,{plain:"",type:"primary",onClick:S},{default:l(()=>[a(w,{class:"mr-5px",icon:"ep:plus"}),e[6]||(e[6]=u(" \u65B0\u589E "))]),_:1})),[[g,["bpm:form:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),a(V,null,{default:l(()=>[c((m(),f(O,{data:t(x)},{default:l(()=>[a(i,{align:"center",label:"\u7F16\u53F7",prop:"id"}),a(i,{align:"center",label:"\u8868\u5355\u540D",prop:"name"}),a(i,{align:"center",label:"\u72B6\u6001",prop:"status"},{default:l(o=>[a(K,{type:t(ae).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5907\u6CE8",prop:"remark"}),a(i,{formatter:t(ye),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},null,8,["formatter"]),a(i,{align:"center",label:"\u64CD\u4F5C"},{default:l(o=>[c((m(),f(s,{link:"",type:"primary",onClick:F=>S(o.row.id)},{default:l(()=>e[7]||(e[7]=[u(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[g,["bpm:form:update"]]]),c((m(),f(s,{link:"",onClick:F=>(async C=>{const q=await we(C);Ce(k,q.conf,q.fields),_.value=!0})(o.row.id)},{default:l(()=>e[8]||(e[8]=[u(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[g,["bpm:form:query"]]]),c((m(),f(s,{link:"",type:"danger",onClick:F=>(async C=>{try{await h.delConfirm(),await ke(C),h.success(z("common.delSuccess")),await d()}catch{}})(o.row.id)},{default:l(()=>e[9]||(e[9]=[u(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[g,["bpm:form:delete"]]])]),_:1})]),_:1},8,["data"])),[[I,t(y)]]),a(P,{limit:t(r).pageSize,"onUpdate:limit":e[1]||(e[1]=o=>t(r).pageSize=o),page:t(r).pageNo,"onUpdate:page":e[2]||(e[2]=o=>t(r).pageNo=o),total:t(v),onPagination:d},null,8,["limit","page","total"])]),_:1}),a(H,{modelValue:t(_),"onUpdate:modelValue":e[3]||(e[3]=o=>le(_)?_.value=o:null),title:"\u8868\u5355\u8BE6\u60C5",width:"800"},{default:l(()=>[a(D,{option:t(k).option,rule:t(k).rule},null,8,["option","rule"])]),_:1},8,["modelValue"])],64)}}});export{he as default};
