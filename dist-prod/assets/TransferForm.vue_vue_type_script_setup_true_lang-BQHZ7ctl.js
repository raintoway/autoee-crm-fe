import{d as G,r as i,e as H,n as K,o as d,q as f,w as r,f as t,x as n,u as a,y as Q,c as T,p as E,F as O,k as N,t as X,a3 as y,O as Y,D as Z,z as $,A as ee,B as ae,C as le,ai as re,aj as se,ac as ue,bO as te,J as oe,I as de,M as ne}from"./index-DPENBzsb.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{g as me}from"./index-Co9HWb9O.js";import{t as fe}from"./index-D0zCJsCp.js";import{a as _e}from"./index-DvyG3vlo.js";import{t as ve}from"./index-zBhacYdK.js";import{t as Ce}from"./index-OU-fIsLR.js";import{t as pe}from"./index-BRgO_Nxc.js";import{P as ce,B as u}from"./index-Cb-L5Bqt.js";const we=G({name:"CrmTransferForm",__name:"TransferForm",props:{bizType:{}},emits:["success"],setup(k,{expose:I,emit:g}){const M=k,b=$(),m=i(!1),c=i(""),_=i(!1),U=i([]),v=i(!1),o=i({}),z=H({newOwnerUserId:[{required:!0,message:"\u65B0\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],oldOwnerPermissionLevel:[{required:!0,message:"\u8001\u8D1F\u8D23\u4EBA\u52A0\u5165\u56E2\u961F\u540E\u7684\u6743\u9650\u7EA7\u522B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=i();I({open:async s=>{m.value=!0,c.value=h(),x(),o.value.id=s}});const L=s=>{s||(o.value.oldOwnerPermissionLevel=void 0)},P=g,A=async()=>{if(C&&await C.value.validate()){_.value=!0;try{const s=o.value;await B(a(s)),b.success(c.value+"\u6210\u529F"),m.value=!1,P("success")}finally{_.value=!1}}},B=async s=>{switch(M.bizType){case u.CRM_CLUE:return await _e(s);case u.CRM_CUSTOMER:return await Ce(s);case u.CRM_CONTACT:return await ve(s);case u.CRM_BUSINESS:return await fe(s);case u.CRM_CONTRACT:return await pe(s);default:throw b.error("\u3010\u8F6C\u79FB\u5931\u8D25\u3011\u6CA1\u6709\u8F6C\u79FB\u63A5\u53E3"),new Error("\u3010\u8F6C\u79FB\u5931\u8D25\u3011\u6CA1\u6709\u8F6C\u79FB\u63A5\u53E3")}},h=()=>{switch(M.bizType){case u.CRM_CLUE:return"\u7EBF\u7D22\u8F6C\u79FB";case u.CRM_CUSTOMER:return"\u5BA2\u6237\u8F6C\u79FB";case u.CRM_CONTACT:return"\u8054\u7CFB\u4EBA\u8F6C\u79FB";case u.CRM_BUSINESS:return"\u5546\u673A\u8F6C\u79FB";case u.CRM_CONTRACT:return"\u5408\u540C\u8F6C\u79FB";default:return"\u8F6C\u79FB"}},x=()=>{var s;(s=C.value)==null||s.resetFields(),o.value={}};return K(async()=>{U.value=await me()}),(s,e)=>{const F=ee,q=ae,p=le,w=re,V=se,R=ue,j=te,D=oe,S=de,J=ie,W=ne;return d(),f(J,{modelValue:a(m),"onUpdate:modelValue":e[5]||(e[5]=l=>N(m)?m.value=l:null),title:a(c),width:"30%"},{footer:r(()=>[t(S,{disabled:a(_),type:"primary",onClick:A},{default:r(()=>e[11]||(e[11]=[n("\u786E \u5B9A")])),_:1},8,["disabled"]),t(S,{onClick:e[4]||(e[4]=l=>m.value=!1)},{default:r(()=>e[12]||(e[12]=[n("\u53D6 \u6D88")])),_:1})]),default:r(()=>[Q((d(),f(D,{ref_key:"formRef",ref:C,model:a(o),rules:a(z),"label-width":"150px"},{default:r(()=>[t(p,{label:"\u9009\u62E9\u65B0\u8D1F\u8D23\u4EBA",prop:"newOwnerUserId"},{default:r(()=>[t(q,{modelValue:a(o).newOwnerUserId,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).newOwnerUserId=l)},{default:r(()=>[(d(!0),T(O,null,E(a(U),l=>(d(),f(F,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"\u8001\u8D1F\u8D23\u4EBA"},{default:r(()=>[t(V,{modelValue:a(v),"onUpdate:modelValue":e[1]||(e[1]=l=>N(v)?v.value=l:null),onChange:L},{default:r(()=>[t(w,{value:!1,size:"large"},{default:r(()=>e[6]||(e[6]=[n("\u79FB\u9664")])),_:1}),t(w,{value:!0,size:"large"},{default:r(()=>e[7]||(e[7]=[n("\u52A0\u5165\u56E2\u961F")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(v)?(d(),f(p,{key:0,label:"\u8001\u8D1F\u8D23\u4EBA\u6743\u9650\u7EA7\u522B",prop:"oldOwnerPermissionLevel"},{default:r(()=>[t(V,{modelValue:a(o).oldOwnerPermissionLevel,"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).oldOwnerPermissionLevel=l)},{default:r(()=>[(d(!0),T(O,null,E(a(Y)(a(Z).CRM_PERMISSION_LEVEL),l=>(d(),T(O,{key:l.value},[l.value!=a(ce).OWNER?(d(),f(w,{key:0,value:l.value},{default:r(()=>[n(X(l.label),1)]),_:2},1032,["value"])):y("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})):y("",!0),s.bizType===a(u).CRM_CUSTOMER?(d(),f(p,{key:1,label:"\u540C\u65F6\u8F6C\u79FB"},{default:r(()=>[t(j,{modelValue:a(o).toBizTypes,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).toBizTypes=l)},{default:r(()=>[t(R,{value:a(u).CRM_CONTACT},{default:r(()=>e[8]||(e[8]=[n("\u8054\u7CFB\u4EBA")])),_:1},8,["value"]),t(R,{value:a(u).CRM_BUSINESS},{default:r(()=>e[9]||(e[9]=[n("\u5546\u673A")])),_:1},8,["value"]),t(R,{value:a(u).CRM_CONTRACT},{default:r(()=>e[10]||(e[10]=[n("\u5408\u540C")])),_:1},8,["value"])]),_:1},8,["modelValue"])]),_:1})):y("",!0)]),_:1},8,["model","rules"])),[[W,a(_)]])]),_:1},8,["modelValue","title"])}}});export{we as _};
