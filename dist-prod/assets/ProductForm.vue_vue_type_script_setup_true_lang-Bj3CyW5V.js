import{d as B,r as i,b as G,e as H,n as K,o as n,q as c,w as o,f as s,x as R,u as l,y as L,c as V,p as U,F as w,O as T,D,k as W,h as X,z as Y,T as Z,C as $,E as ee,A as le,B as ae,bR as se,bQ as oe,i as de,J as ue,I as re,M as te}from"./index-DPENBzsb.js";import{_ as ie}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{a as ne,c as pe,u as me}from"./index-B6l7NQIx.js";import{g as ce}from"./index-BWhMN_YI.js";import{h as ve,d as fe}from"./tree-Cts6wVCK.js";import{g as be}from"./index-Co9HWb9O.js";const _e=B({name:"CrmProductForm",__name:"ProductForm",emits:["success"],setup(ge,{expose:F,emit:P}){const{t:f}=X(),y=Y(),p=i(!1),I=i(""),m=i(!1),h=i(""),S=G().getUser.id,d=i({id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1}),x=H({name:[{required:!0,message:"\u4EA7\u54C1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u4EA7\u54C1\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],categoryId:[{required:!0,message:"\u4EA7\u54C1\u5206\u7C7BID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],price:[{required:!0,message:"\u4EF7\u683C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=i();F({open:async(u,a)=>{if(p.value=!0,I.value=f("action."+u),h.value=u,A(),a){m.value=!0;try{d.value=await ne(a)}finally{m.value=!1}}else d.value.ownerUserId=S}});const M=P,O=async()=>{if(v&&await v.value.validate()){m.value=!0;try{const u=d.value;h.value==="create"?(await pe(u),y.success(f("common.createSuccess"))):(await me(u),y.success(f("common.updateSuccess"))),p.value=!1,M("success")}finally{m.value=!1}}},A=()=>{var u;d.value={id:void 0,name:void 0,no:void 0,unit:void 0,price:NaN,status:void 0,categoryId:void 0,description:void 0,ownerUserId:-1},(u=v.value)==null||u.resetFields()},k=i([]),C=i([]);return K(async()=>{const u=await ce({});k.value=ve(u,"id","parentId"),C.value=await be()}),(u,a)=>{const b=Z,r=$,t=ee,_=le,g=ae,N=se,z=oe,E=de,J=ue,q=re,Q=ie,j=te;return n(),c(Q,{title:l(I),modelValue:l(p),"onUpdate:modelValue":a[9]||(a[9]=e=>W(p)?p.value=e:null)},{footer:o(()=>[s(q,{onClick:O,type:"primary",disabled:l(m)},{default:o(()=>a[10]||(a[10]=[R("\u786E \u5B9A")])),_:1},8,["disabled"]),s(q,{onClick:a[8]||(a[8]=e=>p.value=!1)},{default:o(()=>a[11]||(a[11]=[R("\u53D6 \u6D88")])),_:1})]),default:o(()=>[L((n(),c(J,{ref_key:"formRef",ref:v,model:l(d),rules:l(x),"label-width":"100px"},{default:o(()=>[s(E,null,{default:o(()=>[s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EA7\u54C1\u540D\u79F0",prop:"name"},{default:o(()=>[s(b,{modelValue:l(d).name,"onUpdate:modelValue":a[0]||(a[0]=e=>l(d).name=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:o(()=>[s(g,{modelValue:l(d).ownerUserId,"onUpdate:modelValue":a[1]||(a[1]=e=>l(d).ownerUserId=e),placeholder:"\u8BF7\u9009\u62E9\u8D1F\u8D23\u4EBA",disabled:l(d).id,class:"w-1/1"},{default:o(()=>[(n(!0),V(w,null,U(l(C),e=>(n(),c(_,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EA7\u54C1\u7C7B\u578B",prop:"categoryId"},{default:o(()=>[s(N,{modelValue:l(d).categoryId,"onUpdate:modelValue":a[2]||(a[2]=e=>l(d).categoryId=e),options:l(k),props:l(fe),class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u4EA7\u54C1\u7C7B\u578B",filterable:""},null,8,["modelValue","options","props"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EA7\u54C1\u5355\u4F4D",prop:"unit"},{default:o(()=>[s(g,{modelValue:l(d).unit,"onUpdate:modelValue":a[3]||(a[3]=e=>l(d).unit=e),class:"w-1/1",placeholder:"\u8BF7\u9009\u62E9\u5355\u4F4D"},{default:o(()=>[(n(!0),V(w,null,U(l(T)(l(D).CRM_PRODUCT_UNIT),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EA7\u54C1\u7F16\u7801",prop:"no"},{default:o(()=>[s(b,{modelValue:l(d).no,"onUpdate:modelValue":a[4]||(a[4]=e=>l(d).no=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u7801"},null,8,["modelValue"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EF7\u683C",prop:"price"},{default:o(()=>[s(z,{modelValue:l(d).price,"onUpdate:modelValue":a[5]||(a[5]=e=>l(d).price=e),placeholder:"\u8BF7\u8F93\u5165\u4EF7\u683C",min:0,precision:2,step:.1,class:"w-full!"},null,8,["modelValue"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4EA7\u54C1\u63CF\u8FF0",prop:"description"},{default:o(()=>[s(b,{modelValue:l(d).description,"onUpdate:modelValue":a[6]||(a[6]=e=>l(d).description=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u63CF\u8FF0"},null,8,["modelValue"])]),_:1})]),_:1}),s(t,{span:12},{default:o(()=>[s(r,{label:"\u4E0A\u67B6\u72B6\u6001",prop:"status"},{default:o(()=>[s(g,{modelValue:l(d).status,"onUpdate:modelValue":a[7]||(a[7]=e=>l(d).status=e),placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",class:"w-1/1"},{default:o(()=>[(n(!0),V(w,null,U(l(T)(l(D).CRM_PRODUCT_STATUS),e=>(n(),c(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[j,l(m)]])]),_:1},8,["title","modelValue"])}}});export{_e as _};
