import{d as q,r as o,n as B,o as n,c as E,y as L,u as t,q as c,w as i,x as M,a3 as O,f as a,F as P,z as Q,a as U,P as V,I as W,l as j,m as H,E as X,M as G}from"./index-DPENBzsb.js";import{g as J,_ as K}from"./index-D9VBT2CA.js";import{u as Y}from"./tagsView-uxrzGHKp.js";import{a as Z}from"./index-zBhacYdK.js";import{_ as $}from"./ContactDetailsHeader.vue_vue_type_script_setup_true_lang-Dm-SXXha.js";import{_ as tt}from"./ContactDetailsInfo.vue_vue_type_script_setup_true_lang-CHgZHuXs.js";import{_ as at}from"./BusinessList.vue_vue_type_script_setup_true_lang-zEz5rimS.js";import{_ as it}from"./PermissionList.vue_vue_type_script_setup_true_lang-Ch3d1W7H.js";import{B as s}from"./index-Cb-L5Bqt.js";import{_ as rt}from"./ContactForm.vue_vue_type_script_setup_true_lang-CDIYsxb8.js";import{_ as et}from"./TransferForm.vue_vue_type_script_setup_true_lang-BQHZ7ctl.js";import{_ as ot}from"./index.vue_vue_type_script_setup_true_lang-BVFvTCKz.js";import"./el-timeline-item-DOhCPhED.js";import"./formatTime-C7TQtsxQ.js";import"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import"./el-descriptions-item-BD45d2S6.js";import"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import"./color-DXkOL5Tu.js";import"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import"./index-C2tU_CDa.js";import"./index-D0zCJsCp.js";import"./BusinessForm.vue_vue_type_script_setup_true_lang-aTUZuI7c.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./index-Cj_ALIC1.js";import"./index-OU-fIsLR.js";import"./index-Co9HWb9O.js";import"./BusinessProductForm.vue_vue_type_script_setup_true_lang-z3hq65Lx.js";import"./index-B6l7NQIx.js";import"./BusinessListModal.vue_vue_type_script_setup_true_lang-B4bxVlIN.js";import"./PermissionForm.vue_vue_type_script_setup_true_lang-DymHMb9s.js";import"./index-gTb5e5TR.js";import"./tree-Cts6wVCK.js";import"./index-DvyG3vlo.js";import"./index-BRgO_Nxc.js";import"./FollowUpRecordForm.vue_vue_type_script_setup_true_lang-DooL9HAc.js";import"./FollowUpRecordBusinessForm.vue_vue_type_script_setup_true_lang-B4zmNLSs.js";import"./FollowUpRecordContactForm.vue_vue_type_script_setup_true_lang-Cw7cyvrf.js";import"./ContactListModal.vue_vue_type_script_setup_true_lang-BDJxp_NS.js";const lt=q({name:"CrmContactDetail",__name:"index",setup(mt){const A=Q(),p=o(0),u=o(!0),r=o({}),d=o(),_=async()=>{u.value=!0;try{r.value=await Z(p.value),await g(p.value)}finally{u.value=!1}},y=o(),b=o(),N=()=>{var l;(l=b.value)==null||l.open(r.value.id)},z=o([]),g=async l=>{if(!l)return;const e=await J({bizType:s.CRM_CONTACT,bizId:l});z.value=e.list},{delView:x}=Y(),{currentRoute:I}=U(),f=()=>{x(t(I))},{params:C}=V();return B(async()=>{if(!C.id)return A.warning("\u53C2\u6570\u9519\u8BEF\uFF0C\u8054\u7CFB\u4EBA\u4E0D\u80FD\u4E3A\u7A7A\uFF01"),void f();p.value=C.id,await _()}),(l,e)=>{const v=W,m=j,D=K,F=H,S=X,h=G;return n(),E(P,null,[L((n(),c($,{contact:t(r)},{default:i(()=>{var T,w;return[(T=t(d))!=null&&T.validateWrite?(n(),c(v,{key:0,onClick:e[0]||(e[0]=st=>{return R="update",k=t(r).id,void y.value.open(R,k);var R,k})},{default:i(()=>e[1]||(e[1]=[M(" \u7F16\u8F91 ")])),_:1})):O("",!0),(w=t(d))!=null&&w.validateOwnerUser?(n(),c(v,{key:1,type:"primary",onClick:N},{default:i(()=>e[2]||(e[2]=[M(" \u8F6C\u79FB ")])),_:1})):O("",!0)]}),_:1},8,["contact"])),[[h,t(u)]]),a(S,null,{default:i(()=>[a(F,null,{default:i(()=>[a(m,{label:"\u8DDF\u8FDB\u8BB0\u5F55"},{default:i(()=>[a(ot,{"biz-id":t(p),"biz-type":t(s).CRM_CONTACT},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u8BE6\u7EC6\u8D44\u6599"},{default:i(()=>[a(tt,{contact:t(r)},null,8,["contact"])]),_:1}),a(m,{label:"\u64CD\u4F5C\u65E5\u5FD7"},{default:i(()=>[a(D,{"log-list":t(z)},null,8,["log-list"])]),_:1}),a(m,{label:"\u56E2\u961F\u6210\u5458"},{default:i(()=>[a(it,{ref_key:"permissionListRef",ref:d,"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"show-action":!0,onQuitTeam:f},null,8,["biz-id","biz-type"])]),_:1}),a(m,{label:"\u5546\u673A",lazy:""},{default:i(()=>[a(at,{"biz-id":t(r).id,"biz-type":t(s).CRM_CONTACT,"contact-id":t(r).id,"customer-id":t(r).customerId},null,8,["biz-id","biz-type","contact-id","customer-id"])]),_:1})]),_:1})]),_:1}),a(rt,{ref_key:"formRef",ref:y,onSuccess:_},null,512),a(et,{ref_key:"transferFormRef",ref:b,"biz-type":t(s).CRM_CONTACT,onSuccess:f},null,8,["biz-type"])],64)}}});export{lt as default};
