import{d as R,z,h as A,r as d,e as O,n as j,U as F,o as p,c as P,f as t,w as r,x as g,y,q as u,u as l,D as Q,a3 as Y,F as D,H as q,I as B,K as G,L as H,M as K}from"./index-DPENBzsb.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import{_ as V}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{d as W}from"./formatTime-C7TQtsxQ.js";import{L,_ as X,g as Z,d as $}from"./CustomerLimitConfigForm.vue_vue_type_script_setup_true_lang-BbSnyhn0.js";const ee=R({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{}},setup(T){const w=z(),{t:v}=A(),_=d(!0),k=d(0),b=d([]),s=O({pageNo:1,pageSize:10,type:T.confType}),c=async()=>{_.value=!0;try{const o=await Z(s);b.value=o.list,k.value=o.total}finally{_.value=!1}},N=d(),h=(o,e)=>{N.value.open(o,T.confType,e)},S=()=>{s.pageNo=1,c()};return j(()=>{c()}),(o,e)=>{const I=q,f=B,i=G,x=V,U=H,E=J,C=F("hasPermi"),M=K;return p(),P(D,null,[t(f,{plain:"",onClick:S},{default:r(()=>[t(I,{icon:"ep:refresh",class:"mr-5px"}),e[3]||(e[3]=g(" \u5237\u65B0 "))]),_:1}),y((p(),u(f,{type:"primary",plain:"",onClick:e[0]||(e[0]=a=>h("create"))},{default:r(()=>[t(I,{icon:"ep:plus",class:"mr-5px"}),e[4]||(e[4]=g(" \u65B0\u589E "))]),_:1})),[[C,["crm:customer-limit-config:create"]]]),y((p(),u(U,{data:l(b),stripe:!0,"show-overflow-tooltip":!0,class:"mt-4"},{default:r(()=>[t(i,{label:"\u7F16\u53F7",align:"center",prop:"id"}),t(i,{label:"\u89C4\u5219\u9002\u7528\u4EBA\u7FA4",align:"center",formatter:a=>{var n;return(n=a.users)==null?void 0:n.map(m=>m.nickname).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:"\u89C4\u5219\u9002\u7528\u90E8\u95E8",align:"center",formatter:a=>{var n;return(n=a.depts)==null?void 0:n.map(m=>m.name).join("\uFF0C")}},null,8,["formatter"]),t(i,{label:o.confType===l(L).CUSTOMER_QUANTITY_LIMIT?"\u62E5\u6709\u5BA2\u6237\u6570\u4E0A\u9650":"\u9501\u5B9A\u5BA2\u6237\u6570\u4E0A\u9650",align:"center",prop:"maxCount"},null,8,["label"]),o.confType===l(L).CUSTOMER_QUANTITY_LIMIT?(p(),u(i,{key:0,label:"\u6210\u4EA4\u5BA2\u6237\u662F\u5426\u5360\u7528\u62E5\u6709\u5BA2\u6237\u6570",align:"center",prop:"dealCountEnabled","min-width":"100"},{default:r(a=>[t(x,{type:l(Q).INFRA_BOOLEAN_STRING,value:a.row.dealCountEnabled},null,8,["type","value"])]),_:1})):Y("",!0),t(i,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:l(W),width:"180px"},null,8,["formatter"]),t(i,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:r(a=>[y((p(),u(f,{link:"",type:"primary",onClick:n=>h("update",a.row.id)},{default:r(()=>e[5]||(e[5]=[g(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:update"]]]),y((p(),u(f,{link:"",type:"danger",onClick:n=>(async m=>{try{await w.delConfirm(),await $(m),w.success(v("common.delSuccess")),await c()}catch{}})(a.row.id)},{default:r(()=>e[6]||(e[6]=[g(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[C,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[M,l(_)]]),t(E,{total:l(k),page:l(s).pageNo,"onUpdate:page":e[1]||(e[1]=a=>l(s).pageNo=a),limit:l(s).pageSize,"onUpdate:limit":e[2]||(e[2]=a=>l(s).pageSize=a),onPagination:c},null,8,["total","page","limit"]),t(X,{ref_key:"formRef",ref:N,onSuccess:c},null,512)],64)}}});export{ee as _};
