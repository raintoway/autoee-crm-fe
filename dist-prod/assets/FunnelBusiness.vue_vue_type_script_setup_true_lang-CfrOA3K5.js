import{d as q,r as m,e as W,n as z,o as h,c as D,f as a,w as t,x as v,u as l,y as I,q as T,D as j,F as k,I as A,c$ as L,E as M,i as N,j as U,K,L as O,M as R}from"./index-DPENBzsb.js";import{_ as V}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{E as Y}from"./el-skeleton-item-ByHOrDfP.js";import{_ as G}from"./Echart.vue_vue_type_script_setup_true_lang-BK9hPyJ9.js";import{S as _}from"./funnel-DdZdvo2g.js";const H=q({name:"FunnelBusiness",__name:"FunnelBusiness",props:{queryParams:{}},setup(g,{expose:S}){const d=g,p=m(!0),u=m(!1),f=m([]),n=W({title:{text:"\u9500\u552E\u6F0F\u6597"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}"},toolbox:{feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},legend:{data:["\u5BA2\u6237","\u5546\u673A","\u8D62\u5355"]},series:[{name:"\u9500\u552E\u6F0F\u6597",type:"funnel",left:"10%",top:60,bottom:60,width:"80%",min:0,max:100,minSize:"0%",maxSize:"100%",sort:"descending",gap:2,label:{show:!0,position:"inside"},labelLine:{length:10,lineStyle:{width:1,type:"solid"}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{fontSize:20}},data:[{value:60,name:"\u5BA2\u6237-0\u4E2A"},{value:40,name:"\u5546\u673A-0\u4E2A"},{value:20,name:"\u8D62\u5355-0\u4E2A"}]}]}),c=async s=>{p.value=s,await o()},o=async()=>{u.value=!0;const s=await _.getFunnelSummary(d.queryParams);if(s&&n.series&&n.series[0]&&n.series[0].data){const e=[];p.value?(e.push({value:60,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:40,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:20,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})):(e.push({value:s.customerCount||0,name:`\u5BA2\u6237-${s.customerCount||0}\u4E2A`}),e.push({value:s.businessCount||0,name:`\u5546\u673A-${s.businessCount||0}\u4E2A`}),e.push({value:s.businessWinCount||0,name:`\u8D62\u5355-${s.businessWinCount||0}\u4E2A`})),n.series[0].data=e}f.value=await _.getBusinessSummaryByEndStatus(d.queryParams),u.value=!1};return S({loadData:o}),z(()=>{o()}),(s,e)=>{const b=A,w=L,C=G,x=Y,$=M,E=N,y=U,i=K,B=V,F=O,P=R;return h(),D(k,null,[a(y,{shadow:"never"},{default:t(()=>[a(E,null,{default:t(()=>[a($,{span:24},{default:t(()=>[a(w,{class:"mb-10px"},{default:t(()=>[a(b,{type:"primary",onClick:e[0]||(e[0]=r=>c(!0))},{default:t(()=>e[2]||(e[2]=[v("\u5BA2\u6237\u89C6\u89D2")])),_:1}),a(b,{type:"primary",onClick:e[1]||(e[1]=r=>c(!1))},{default:t(()=>e[3]||(e[3]=[v("\u52A8\u6001\u89C6\u89D2")])),_:1})]),_:1}),a(x,{loading:l(u),animated:""},{default:t(()=>[a(C,{height:500,options:l(n)},null,8,["options"])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),a(y,{class:"mt-16px",shadow:"never"},{default:t(()=>[I((h(),T(F,{data:l(f)},{default:t(()=>[a(i,{align:"center",label:"\u5E8F\u53F7",type:"index",width:"80"}),a(i,{align:"center",label:"\u9636\u6BB5",prop:"endStatus",width:"200"},{default:t(r=>[a(B,{type:l(j).CRM_BUSINESS_END_STATUS_TYPE,value:r.row.endStatus},null,8,["type","value"])]),_:1}),a(i,{align:"center",label:"\u5546\u673A\u6570","min-width":"200",prop:"businessCount"}),a(i,{align:"center",label:"\u5546\u673A\u603B\u91D1\u989D(\u5143)","min-width":"200",prop:"totalPrice"})]),_:1},8,["data"])),[[P,l(u)]])]),_:1})],64)}}});export{H as _};
