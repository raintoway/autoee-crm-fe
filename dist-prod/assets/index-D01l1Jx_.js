import{d as X,z as Z,h as $,r as i,e as ee,a as ae,n as le,U as te,o as d,c as re,f as e,w as r,u as t,N as T,x as s,y as w,q as b,k as oe,t as ne,D as N,F as pe,T as ie,C as se,A as ue,B as me,H as de,I as ce,J as fe,l as we,m as be,ad as _e,K as he,L as ge,M as ye}from"./index-DPENBzsb.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import{_ as Ce}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{_ as ve}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{_ as ke}from"./index-CbaPuDB3.js";import{d as y}from"./formatTime-C7TQtsxQ.js";import{d as Ve}from"./download-oWiM5xVU.js";import{b as Ue,e as Se,f as Te}from"./index-DvyG3vlo.js";import{_ as Ne}from"./ClueForm.vue_vue_type_script_setup_true_lang-BQYsVskf.js";import"./index-C2tU_CDa.js";import"./color-DXkOL5Tu.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./index-gTb5e5TR.js";import"./tree-Cts6wVCK.js";import"./index-Co9HWb9O.js";const Re=X({name:"CrmClue",__name:"index",setup(Me){const x=Z(),{t:A}=$(),C=i(!0),R=i(0),M=i([]),n=ee({pageNo:1,pageSize:10,sceneType:"1",name:null,telephone:null,mobile:null,transformStatus:!1}),E=i(),v=i(!1),k=i("1"),c=async()=>{C.value=!0;try{const p=await Ue(n);M.value=p.list,R.value=p.total}finally{C.value=!1}},u=()=>{n.pageNo=1,c()},F=()=>{E.value.resetFields(),u()},P=p=>{n.sceneType=p.paneName,u()},{push:q}=ae(),K=i(),L=(p,a)=>{K.value.open(p,a)},B=async()=>{try{await x.exportConfirm(),v.value=!0;const p=await Te(n);Ve.excel(p,"\u7EBF\u7D22.xls")}catch{}finally{v.value=!1}};return le(()=>{c()}),(p,a)=>{const O=ke,V=ie,f=se,z=ue,H=me,_=de,m=ce,J=fe,D=ve,U=we,Y=be,j=_e,o=he,S=Ce,G=ge,Q=xe,h=te("hasPermi"),W=ye;return d(),re(pe,null,[e(O,{title:"\u3010\u7EBF\u7D22\u3011\u7EBF\u7D22\u7BA1\u7406",url:"https://doc.iocoder.cn/crm/clue/"}),e(O,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(D,null,{default:r(()=>[e(J,{class:"-mb-15px",model:t(n),ref_key:"queryFormRef",ref:E,inline:!0,"label-width":"68px"},{default:r(()=>[e(f,{label:"\u7EBF\u7D22\u540D\u79F0",prop:"name"},{default:r(()=>[e(V,{modelValue:t(n).name,"onUpdate:modelValue":a[0]||(a[0]=l=>t(n).name=l),placeholder:"\u8BF7\u8F93\u5165\u7EBF\u7D22\u540D\u79F0",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,{label:"\u8F6C\u5316\u72B6\u6001",prop:"transformStatus"},{default:r(()=>[e(H,{modelValue:t(n).transformStatus,"onUpdate:modelValue":a[1]||(a[1]=l=>t(n).transformStatus=l),class:"!w-240px"},{default:r(()=>[e(z,{value:!1,label:"\u672A\u8F6C\u5316"}),e(z,{value:!0,label:"\u5DF2\u8F6C\u5316"})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"\u624B\u673A\u53F7",prop:"mobile"},{default:r(()=>[e(V,{modelValue:t(n).mobile,"onUpdate:modelValue":a[2]||(a[2]=l=>t(n).mobile=l),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,{label:"\u7535\u8BDD",prop:"telephone"},{default:r(()=>[e(V,{modelValue:t(n).telephone,"onUpdate:modelValue":a[3]||(a[3]=l=>t(n).telephone=l),placeholder:"\u8BF7\u8F93\u5165\u7535\u8BDD",clearable:"",onKeyup:T(u,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(f,null,{default:r(()=>[e(m,{onClick:u},{default:r(()=>[e(_,{icon:"ep:search",class:"mr-5px"}),a[8]||(a[8]=s(" \u641C\u7D22"))]),_:1}),e(m,{onClick:F},{default:r(()=>[e(_,{icon:"ep:refresh",class:"mr-5px"}),a[9]||(a[9]=s(" \u91CD\u7F6E"))]),_:1}),w((d(),b(m,{type:"primary",onClick:a[4]||(a[4]=l=>L("create"))},{default:r(()=>[e(_,{icon:"ep:plus",class:"mr-5px"}),a[10]||(a[10]=s(" \u65B0\u589E "))]),_:1})),[[h,["crm:clue:create"]]]),w((d(),b(m,{type:"success",plain:"",onClick:B,loading:t(v)},{default:r(()=>[e(_,{icon:"ep:download",class:"mr-5px"}),a[11]||(a[11]=s(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[h,["crm:clue:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(D,null,{default:r(()=>[e(Y,{modelValue:t(k),"onUpdate:modelValue":a[5]||(a[5]=l=>oe(k)?k.value=l:null),onTabClick:P},{default:r(()=>[e(U,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(U,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(U,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),w((d(),b(G,{data:t(M),stripe:!0,"show-overflow-tooltip":!0},{default:r(()=>[e(o,{label:"\u7EBF\u7D22\u540D\u79F0",align:"center",prop:"name",fixed:"left",width:"160"},{default:r(l=>[e(j,{underline:!1,type:"primary",onClick:I=>{return g=l.row.id,void q({name:"CrmClueDetail",params:{id:g}});var g}},{default:r(()=>[s(ne(l.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(o,{label:"\u7EBF\u7D22\u6765\u6E90",align:"center",prop:"source",width:"100"},{default:r(l=>[e(S,{type:t(N).CRM_CUSTOMER_SOURCE,value:l.row.source},null,8,["type","value"])]),_:1}),e(o,{label:"\u624B\u673A",align:"center",prop:"mobile",width:"120"}),e(o,{label:"\u7535\u8BDD",align:"center",prop:"telephone",width:"130"}),e(o,{label:"\u90AE\u7BB1",align:"center",prop:"email",width:"180"}),e(o,{label:"\u5730\u5740",align:"center",prop:"detailAddress",width:"180"}),e(o,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:r(l=>[e(S,{type:t(N).CRM_CUSTOMER_INDUSTRY,value:l.row.industryId},null,8,["type","value"])]),_:1}),e(o,{align:"center",label:"\u5BA2\u6237\u7EA7\u522B",prop:"level",width:"135"},{default:r(l=>[e(S,{type:t(N).CRM_CUSTOMER_LEVEL,value:l.row.level},null,8,["type","value"])]),_:1}),e(o,{formatter:t(y),align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(o,{label:"\u6700\u540E\u8DDF\u8FDB\u65F6\u95F4",align:"center",prop:"contactLastTime",formatter:t(y),width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u8BB0\u5F55",prop:"contactLastContent",width:"200"}),e(o,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"100px"}),e(o,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100"}),e(o,{label:"\u66F4\u65B0\u65F6\u95F4",align:"center",prop:"updateTime",formatter:t(y),width:"180px"},null,8,["formatter"]),e(o,{label:"\u521B\u5EFA\u65F6\u95F4",align:"center",prop:"createTime",formatter:t(y),width:"180px"},null,8,["formatter"]),e(o,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),e(o,{label:"\u64CD\u4F5C",align:"center","min-width":"110",fixed:"right"},{default:r(l=>[w((d(),b(m,{link:"",type:"primary",onClick:I=>L("update",l.row.id)},{default:r(()=>a[12]||(a[12]=[s(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[h,["crm:clue:update"]]]),w((d(),b(m,{link:"",type:"danger",onClick:I=>(async g=>{try{await x.delConfirm(),await Se(g),x.success(A("common.delSuccess")),await c()}catch{}})(l.row.id)},{default:r(()=>a[13]||(a[13]=[s(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[h,["crm:clue:delete"]]])]),_:1})]),_:1},8,["data"])),[[W,t(C)]]),e(Q,{total:t(R),page:t(n).pageNo,"onUpdate:page":a[6]||(a[6]=l=>t(n).pageNo=l),limit:t(n).pageSize,"onUpdate:limit":a[7]||(a[7]=l=>t(n).pageSize=l),onPagination:c},null,8,["total","page","limit"])]),_:1}),e(Ne,{ref_key:"formRef",ref:K,onSuccess:c},null,512)],64)}}});export{Re as default};
