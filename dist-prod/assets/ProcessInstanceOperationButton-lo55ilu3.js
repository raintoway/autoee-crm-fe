import{d as Ye,av as Me,r as v,e as x,a1 as Ie,aw as $e,o as n,c as y,g as U,u as a,q as b,w as l,f as s,x as d,t as k,y as F,k as He,a3 as w,F as L,p as Q,a as Qe,z as We,H as Xe,I as Ze,al as ea,j as aa,T as la,C as sa,J as ra,dc as ta,A as ia,B as oa,M as na,_ as da}from"./index-DPENBzsb.js";import{E as ua}from"./el-image-DqGFoayu.js";import{b as ca}from"./formCreate-BQ5MeUYD.js";import{a as pa,b as fa,r as ma,c as ga,t as va,d as ba,s as ya,e as xa,f as ka,T as _a}from"./index-D2cLVQ1T.js";import{d as wa}from"./index-DetSWMsK.js";import{y as m,O as ha}from"./consts-Dqfik1EE.js";import{B as Ua,c as ue}from"./constants-C8tGWvl2.js";import{_ as Ia}from"./SignDialog.vue_vue_type_script_setup_true_lang-C2loz8wX.js";import"./download-oWiM5xVU.js";const Va={class:"h-50px bottom-10 text-14px flex items-center color-#32373c dark:color-#fff font-bold btn-container"},Ra={class:"flex flex-col flex-1 pt-20px px-20px"},Ca={class:"el-icon-picture-outline"},Sa={class:"flex flex-col flex-1 pt-20px px-20px"},Ea={class:"flex flex-col flex-1 pt-20px px-20px"},Ta={class:"flex flex-col flex-1 pt-20px px-20px"},Fa={class:"flex flex-col flex-1 pt-20px px-20px"},Da={class:"flex flex-col flex-1 pt-20px px-20px"},Pa={class:"flex flex-col flex-1 pt-20px px-20px"},Aa={class:"flex flex-col flex-1 pt-20px px-20px"},qa={class:"flex flex-col flex-1 pt-20px px-20px"},Na=da(Ye({name:"ProcessInstanceBtnContainer",__name:"ProcessInstanceOperationButton",props:{processInstance:{},processDefinition:{},userOptions:{},normalForm:{},normalFormApi:{},writableFields:{}},emits:["success"],setup(Ve,{expose:Re,emit:Ce}){const Se=Qe(),h=We(),ce=Me().getUser.id,Ee=Ce,Y=Ve,i=v(!1),g=v({approve:!1,reject:!1,transfer:!1,delegate:!1,addSign:!1,return:!1,copy:!1,cancel:!1,deleteSign:!1}),ie=v([]),u=v(),D=v({}),M=v({}),oe=v(),ne=v(),pe=v(),fe=v(),I=x({reason:"",signPicUrl:""}),Te=Ie(()=>({reason:[{required:oe.value,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],signPicUrl:[{required:!0,message:"\u7B7E\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]})),de=v(),re=x({reason:""}),Fe=Ie(()=>({reason:[{required:oe.value,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]})),W=v(),A=x({copyUserIds:[],copyReason:""}),De=x({copyUserIds:[{required:!0,message:"\u6284\u9001\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),X=v(),q=x({assigneeUserId:void 0,reason:""}),Pe=x({assigneeUserId:[{required:!0,message:"\u65B0\u5BA1\u6279\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),Z=v(),N=x({delegateUserId:void 0,reason:""}),Ae=x({delegateUserId:[{required:!0,message:"\u63A5\u6536\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),ee=v(),O=x({addSignUserIds:void 0,reason:""}),qe=x({addSignUserIds:[{required:!0,message:"\u52A0\u7B7E\u5904\u7406\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),ae=v(),j=x({deleteSignTaskId:void 0,reason:""}),Ne=x({deleteSignTaskId:[{required:!0,message:"\u51CF\u7B7E\u4EBA\u5458\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],reason:[{required:!0,message:"\u5BA1\u6279\u610F\u89C1\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),le=v(),z=x({targetTaskDefinitionKey:void 0,returnReason:""}),Oe=x({targetTaskDefinitionKey:[{required:!0,message:"\u9000\u56DE\u8282\u70B9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],returnReason:[{required:!0,message:"\u9000\u56DE\u7406\u7531\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),se=v(),te=x({cancelReason:""}),je=x({cancelReason:[{required:!0,message:"\u53D6\u6D88\u7406\u7531\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});$e(()=>M.value,t=>{var e,c;(e=t==null?void 0:t.btn)==null||e.show(!1),(c=t==null?void 0:t.resetBtn)==null||c.show(!1)},{deep:!0});const V=async t=>{if(t==="approve"&&!await Ge())return void h.warning("\u8868\u5355\u6821\u9A8C\u4E0D\u901A\u8FC7\uFF0C\u8BF7\u5148\u5B8C\u5584\u8868\u5355!!");t!=="return"||(ie.value=await pa(u.value.id),ie.value.length!==0)?Object.keys(g.value).forEach(e=>{g.value[e]=e===t}):h.warning("\u5F53\u524D\u6CA1\u6709\u53EF\u9000\u56DE\u7684\u8282\u70B9")},R=(t,e)=>{e&&e.resetFields(),g.value[t]=!1},me=async(t,e)=>{var c;i.value=!0;try{if(!e)return;if(await e.validate(),t){const o=Be(),P={id:u.value.id,reason:I.reason,variables:o};u.value.signEnable&&(P.signPicUrl=I.signPicUrl);const J=M.value;((c=Object.keys(J))==null?void 0:c.length)>0&&(await J.validate(),P.variables=D.value.value),await fa(P),g.value.approve=!1,h.success("\u5BA1\u6279\u901A\u8FC7\u6210\u529F")}else{const o={id:u.value.id,reason:re.reason};await ma(o),g.value.reject=!1,h.success("\u5BA1\u6279\u4E0D\u901A\u8FC7\u6210\u529F")}e.resetFields(),K()}finally{i.value=!1}},ze=async()=>{i.value=!0;try{if(!W.value)return;await W.value.validate();const t={id:u.value.id,reason:A.copyReason,copyUserIds:A.copyUserIds};await ga(t),W.value.resetFields(),g.value.copy=!1,h.success("\u64CD\u4F5C\u6210\u529F")}finally{i.value=!1}},ge=async t=>{i.value=!0;try{if(!ee.value)return;await ee.value.validate();const e={id:u.value.id,type:t,reason:O.reason,userIds:O.addSignUserIds};await ya(e),h.success("\u64CD\u4F5C\u6210\u529F"),ee.value.resetFields(),g.value.addSign=!1,K()}finally{i.value=!1}},Ke=t=>{var c,o,P,J;const e=((c=t==null?void 0:t.assigneeUser)==null?void 0:c.deptName)||((o=t==null?void 0:t.ownerUser)==null?void 0:o.deptName);return`${((P=t==null?void 0:t.assigneeUser)==null?void 0:P.nickname)||((J=t==null?void 0:t.ownerUser)==null?void 0:J.nickname)} ( \u6240\u5C5E\u90E8\u95E8\uFF1A${e} )`},K=()=>{Ee("success")},G=()=>{var e;let t=!1;return _a.RUNNING===((e=u.value)==null?void 0:e.status)&&(t=!0),t},ve=t=>{let e=!1;return ue.APPROVE!==t&&ue.REJECT!==t&&ue.CANCEL!==t||(e=!0),e},B=t=>{var c,o;let e=!0;return(c=u.value)!=null&&c.buttonsSetting&&((o=u.value)!=null&&o.buttonsSetting[t])&&(e=u.value.buttonsSetting[t].enable),e},_=t=>{var c,o;let e=ha.get(t);return(c=u.value)!=null&&c.buttonsSetting&&((o=u.value)!=null&&o.buttonsSetting[t])&&(e=u.value.buttonsSetting[t].displayName),e},Ge=async()=>{var t,e;if(((t=Y.processDefinition)==null?void 0:t.formType)===Ua.NORMAL){let c=!0;try{await((e=Y.normalFormApi)==null?void 0:e.validate())}catch{c=!1}return c}return!0},Be=()=>{const t={};return Y.writableFields.forEach(e=>{t[e]=Y.normalFormApi.getValue(e)}),t},Je=t=>{I.signPicUrl=t,fe.value.validate("change")};return Re({loadTodoTask:t=>{if(D.value={},M.value={},u.value=t,oe.value=(t==null?void 0:t.reasonRequire)??!1,t&&t.formId&&t.formConf){const e={};ca(e,t.formConf,t.formFields,t.formVariables),D.value=e}else D.value={}}}),(t,e)=>{var be,ye,xe,ke,_e,we,he,Ue;const c=Xe,o=Ze,P=ea("form-create"),J=aa,C=la,p=sa,Le=ua,S=ra,E=ta,$=ia,H=oa,T=na;return n(),y(L,null,[U("div",Va,[a(u)&&G()&&B(a(m).APPROVE)?(n(),b(E,{key:0,visible:a(g).approve,placement:"top-end",width:420,trigger:"click"},{reference:l(()=>[s(o,{plain:"",type:"success",onClick:e[0]||(e[0]=r=>V("approve"))},{default:l(()=>[s(c,{icon:"ep:select"}),d("\xA0 "+k(_(a(m).APPROVE)),1)]),_:1})]),default:l(()=>[F((n(),y("div",Ra,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"approveFormRef",ref:ne,model:a(I),rules:a(Te),"label-width":"100px"},{default:l(()=>{var r;return[((r=a(u))==null?void 0:r.formId)>0?(n(),b(J,{key:0,class:"mb-15px !-mt-10px"},{header:l(()=>{var f;return[U("span",Ca," \u586B\u5199\u8868\u5355\u3010"+k((f=a(u))==null?void 0:f.formName)+"\u3011 ",1)]}),default:l(()=>[s(P,{modelValue:a(D).value,"onUpdate:modelValue":e[1]||(e[1]=f=>a(D).value=f),api:a(M),"onUpdate:api":e[2]||(e[2]=f=>He(M)?M.value=f:null),option:a(D).option,rule:a(D).rule},null,8,["modelValue","api","option","rule"])]),_:1})):w("",!0),s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(I).reason,"onUpdate:modelValue":e[3]||(e[3]=f=>a(I).reason=f),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),a(u).signEnable?(n(),b(p,{key:1,label:"\u7B7E\u540D",prop:"signPicUrl",ref_key:"approveSignFormRef",ref:fe},{default:l(()=>[s(o,{onClick:e[4]||(e[4]=f=>a(pe).open())},{default:l(()=>e[46]||(e[46]=[d("\u70B9\u51FB\u7B7E\u540D")])),_:1}),a(I).signPicUrl?(n(),b(Le,{key:0,class:"w-90px h-40px ml-5px",src:a(I).signPicUrl,"preview-src-list":[a(I).signPicUrl]},null,8,["src","preview-src-list"])):w("",!0)]),_:1},512)):w("",!0),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"success",onClick:e[5]||(e[5]=f=>me(!0,a(ne)))},{default:l(()=>[d(k(_(a(m).APPROVE)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[6]||(e[6]=f=>R("approve",a(ne)))},{default:l(()=>e[47]||(e[47]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]}),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).REJECT)?(n(),b(E,{key:1,visible:a(g).reject,placement:"top-end",width:420,trigger:"click"},{reference:l(()=>[s(o,{class:"mr-20px",plain:"",type:"danger",onClick:e[7]||(e[7]=r=>V("reject"))},{default:l(()=>[s(c,{icon:"ep:close"}),d("\xA0 "+k(_(a(m).REJECT)),1)]),_:1})]),default:l(()=>[F((n(),y("div",Sa,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"rejectFormRef",ref:de,model:a(re),rules:a(Fe),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(re).reason,"onUpdate:modelValue":e[8]||(e[8]=r=>a(re).reason=r),placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:4},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"danger",onClick:e[9]||(e[9]=r=>me(!1,a(de)))},{default:l(()=>[d(k(_(a(m).REJECT)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[10]||(e[10]=r=>R("reject",a(de)))},{default:l(()=>e[48]||(e[48]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).COPY)?(n(),b(E,{key:2,visible:a(g).copy,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[11]||(e[11]=r=>V("copy")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"svg-icon:send"}),d("\xA0 "+k(_(a(m).COPY)),1)])]),default:l(()=>[F((n(),y("div",Ea,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"copyFormRef",ref:W,model:a(A),rules:a(De),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u6284\u9001\u4EBA",prop:"copyUserIds"},{default:l(()=>[s(H,{modelValue:a(A).copyUserIds,"onUpdate:modelValue":e[12]||(e[12]=r=>a(A).copyUserIds=r),clearable:"",style:{width:"100%"},multiple:"",placeholder:"\u8BF7\u9009\u62E9\u6284\u9001\u4EBA"},{default:l(()=>[(n(!0),y(L,null,Q(t.userOptions,r=>(n(),b($,{key:r.id,label:r.nickname,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u6284\u9001\u610F\u89C1",prop:"copyReason"},{default:l(()=>[s(C,{modelValue:a(A).copyReason,"onUpdate:modelValue":e[13]||(e[13]=r=>a(A).copyReason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u6284\u9001\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:ze},{default:l(()=>[d(k(_(a(m).COPY)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[14]||(e[14]=r=>R("copy",a(W)))},{default:l(()=>e[49]||(e[49]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).TRANSFER)?(n(),b(E,{key:3,visible:a(g).transfer,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[15]||(e[15]=r=>V("transfer")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"fa:share-square-o"}),d("\xA0 "+k(_(a(m).TRANSFER)),1)])]),default:l(()=>[F((n(),y("div",Ta,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"transferFormRef",ref:X,model:a(q),rules:a(Pe),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u65B0\u5BA1\u6279\u4EBA",prop:"assigneeUserId"},{default:l(()=>[s(H,{modelValue:a(q).assigneeUserId,"onUpdate:modelValue":e[16]||(e[16]=r=>a(q).assigneeUserId=r),clearable:"",style:{width:"100%"}},{default:l(()=>[(n(!0),y(L,null,Q(t.userOptions,r=>(n(),b($,{key:r.id,label:r.nickname,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(q).reason,"onUpdate:modelValue":e[17]||(e[17]=r=>a(q).reason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[18]||(e[18]=r=>(async()=>{i.value=!0;try{if(!X.value)return;await X.value.validate();const f={id:u.value.id,reason:q.reason,assigneeUserId:q.assigneeUserId};await va(f),X.value.resetFields(),g.value.transfer=!1,h.success("\u64CD\u4F5C\u6210\u529F"),K()}finally{i.value=!1}})())},{default:l(()=>[d(k(_(a(m).TRANSFER)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[19]||(e[19]=r=>R("transfer",a(X)))},{default:l(()=>e[50]||(e[50]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).DELEGATE)?(n(),b(E,{key:4,visible:a(g).delegate,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[20]||(e[20]=r=>V("delegate")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"ep:position"}),d("\xA0 "+k(_(a(m).DELEGATE)),1)])]),default:l(()=>[F((n(),y("div",Fa,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"delegateFormRef",ref:Z,model:a(N),rules:a(Ae),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u63A5\u6536\u4EBA",prop:"delegateUserId"},{default:l(()=>[s(H,{modelValue:a(N).delegateUserId,"onUpdate:modelValue":e[21]||(e[21]=r=>a(N).delegateUserId=r),clearable:"",style:{width:"100%"}},{default:l(()=>[(n(!0),y(L,null,Q(t.userOptions,r=>(n(),b($,{key:r.id,label:r.nickname,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(N).reason,"onUpdate:modelValue":e[22]||(e[22]=r=>a(N).reason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[23]||(e[23]=r=>(async()=>{i.value=!0;try{if(!Z.value)return;await Z.value.validate();const f={id:u.value.id,reason:N.reason,delegateUserId:N.delegateUserId};await ba(f),g.value.delegate=!1,Z.value.resetFields(),h.success("\u64CD\u4F5C\u6210\u529F"),K()}finally{i.value=!1}})())},{default:l(()=>[d(k(_(a(m).DELEGATE)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[24]||(e[24]=r=>R("delegate",a(Z)))},{default:l(()=>e[51]||(e[51]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).ADD_SIGN)?(n(),b(E,{key:5,visible:a(g).addSign,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[25]||(e[25]=r=>V("addSign")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"ep:plus"}),d("\xA0 "+k(_(a(m).ADD_SIGN)),1)])]),default:l(()=>[F((n(),y("div",Da,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"addSignFormRef",ref:ee,model:a(O),rules:a(qe),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u52A0\u7B7E\u5904\u7406\u4EBA",prop:"addSignUserIds"},{default:l(()=>[s(H,{modelValue:a(O).addSignUserIds,"onUpdate:modelValue":e[26]||(e[26]=r=>a(O).addSignUserIds=r),multiple:"",clearable:"",style:{width:"100%"}},{default:l(()=>[(n(!0),y(L,null,Q(t.userOptions,r=>(n(),b($,{key:r.id,label:r.nickname,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(O).reason,"onUpdate:modelValue":e[27]||(e[27]=r=>a(O).reason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[28]||(e[28]=r=>ge("before"))},{default:l(()=>[d(" \u5411\u524D"+k(_(a(m).ADD_SIGN)),1)]),_:1},8,["disabled"]),s(o,{disabled:a(i),type:"primary",onClick:e[29]||(e[29]=r=>ge("after"))},{default:l(()=>[d(" \u5411\u540E"+k(_(a(m).ADD_SIGN)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[30]||(e[30]=r=>R("addSign",a(ee)))},{default:l(()=>e[52]||(e[52]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),((be=a(u))==null?void 0:be.children.length)>0?(n(),b(E,{key:6,visible:a(g).deleteSign,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[31]||(e[31]=r=>V("deleteSign")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"ep:semi-select"}),e[53]||(e[53]=d("\xA0 \u51CF\u7B7E "))])]),default:l(()=>[F((n(),y("div",Pa,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"deleteSignFormRef",ref:ae,model:a(j),rules:a(Ne),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u51CF\u7B7E\u4EBA\u5458",prop:"deleteSignTaskId"},{default:l(()=>[s(H,{modelValue:a(j).deleteSignTaskId,"onUpdate:modelValue":e[32]||(e[32]=r=>a(j).deleteSignTaskId=r),clearable:"",style:{width:"100%"}},{default:l(()=>[(n(!0),y(L,null,Q(a(u).children,r=>(n(),b($,{key:r.id,label:Ke(r),value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u5BA1\u6279\u610F\u89C1",prop:"reason"},{default:l(()=>[s(C,{modelValue:a(j).reason,"onUpdate:modelValue":e[33]||(e[33]=r=>a(j).reason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA1\u6279\u610F\u89C1",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[34]||(e[34]=r=>(async()=>{i.value=!0;try{if(!ae.value)return;await ae.value.validate();const f={id:j.deleteSignTaskId,reason:j.reason};await ka(f),h.success("\u51CF\u7B7E\u6210\u529F"),ae.value.resetFields(),g.value.deleteSign=!1,K()}finally{i.value=!1}})())},{default:l(()=>e[54]||(e[54]=[d(" \u51CF\u7B7E ")])),_:1},8,["disabled"]),s(o,{onClick:e[35]||(e[35]=r=>R("deleteSign",a(ae)))},{default:l(()=>e[55]||(e[55]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(u)&&G()&&B(a(m).RETURN)?(n(),b(E,{key:7,visible:a(g).return,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[36]||(e[36]=r=>V("return")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"ep:back"}),d("\xA0 "+k(_(a(m).RETURN)),1)])]),default:l(()=>[F((n(),y("div",Aa,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"returnFormRef",ref:le,model:a(z),rules:a(Oe),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u9000\u56DE\u8282\u70B9",prop:"targetTaskDefinitionKey"},{default:l(()=>[s(H,{modelValue:a(z).targetTaskDefinitionKey,"onUpdate:modelValue":e[37]||(e[37]=r=>a(z).targetTaskDefinitionKey=r),clearable:"",style:{width:"100%"}},{default:l(()=>[(n(!0),y(L,null,Q(a(ie),r=>(n(),b($,{key:r.taskDefinitionKey,label:r.name,value:r.taskDefinitionKey},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(p,{label:"\u9000\u56DE\u7406\u7531",prop:"returnReason"},{default:l(()=>[s(C,{modelValue:a(z).returnReason,"onUpdate:modelValue":e[38]||(e[38]=r=>a(z).returnReason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u9000\u56DE\u7406\u7531",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[39]||(e[39]=r=>(async()=>{i.value=!0;try{if(!le.value)return;await le.value.validate();const f={id:u.value.id,reason:z.returnReason,targetTaskDefinitionKey:z.targetTaskDefinitionKey};await xa(f),g.value.return=!1,le.value.resetFields(),h.success("\u64CD\u4F5C\u6210\u529F"),K()}finally{i.value=!1}})())},{default:l(()=>[d(k(_(a(m).RETURN)),1)]),_:1},8,["disabled"]),s(o,{onClick:e[40]||(e[40]=r=>R("return",a(le)))},{default:l(()=>e[56]||(e[56]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])):w("",!0),a(ce)!==((xe=(ye=t.processInstance)==null?void 0:ye.startUser)==null?void 0:xe.id)||ve((ke=t.processInstance)==null?void 0:ke.status)?w("",!0):(n(),b(E,{key:8,visible:a(g).cancel,placement:"top-start",width:420,trigger:"click"},{reference:l(()=>[U("div",{onClick:e[41]||(e[41]=r=>V("cancel")),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"fa:mail-reply"}),e[57]||(e[57]=d("\xA0 \u53D6\u6D88 "))])]),default:l(()=>[F((n(),y("div",qa,[s(S,{"label-position":"top",class:"mb-auto",ref_key:"cancelFormRef",ref:se,model:a(te),rules:a(je),"label-width":"100px"},{default:l(()=>[s(p,{label:"\u53D6\u6D88\u7406\u7531",prop:"cancelReason"},{default:l(()=>[e[58]||(e[58]=U("span",{class:"text-#878c93 text-12px"},"\xA0 \u53D6\u6D88\u540E\uFF0C\u8BE5\u5BA1\u6279\u6D41\u7A0B\u5C06\u81EA\u52A8\u7ED3\u675F",-1)),s(C,{modelValue:a(te).cancelReason,"onUpdate:modelValue":e[42]||(e[42]=r=>a(te).cancelReason=r),clearable:"",placeholder:"\u8BF7\u8F93\u5165\u53D6\u6D88\u7406\u7531",type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),s(p,null,{default:l(()=>[s(o,{disabled:a(i),type:"primary",onClick:e[43]||(e[43]=r=>(async()=>{i.value=!0;try{if(!se.value)return;await se.value.validate(),await wa(Y.processInstance.id,te.cancelReason),g.value.return=!1,h.success("\u64CD\u4F5C\u6210\u529F"),se.value.resetFields(),K()}finally{i.value=!1}})())},{default:l(()=>e[59]||(e[59]=[d(" \u786E\u8BA4 ")])),_:1},8,["disabled"]),s(o,{onClick:e[44]||(e[44]=r=>R("cancel",a(se)))},{default:l(()=>e[60]||(e[60]=[d(" \u53D6\u6D88 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])])),[[T,a(i)]])]),_:1},8,["visible"])),a(ce)===((we=(_e=t.processInstance)==null?void 0:_e.startUser)==null?void 0:we.id)&&ve((he=t.processInstance)==null?void 0:he.status)&&((Ue=t.processDefinition)==null?void 0:Ue.formType)===10?(n(),y("div",{key:9,onClick:e[45]||(e[45]=r=>(async()=>{var f;await Se.push({name:"BpmProcessInstanceCreate",query:{processInstanceId:(f=Y.processInstance)==null?void 0:f.id}})})()),class:"hover-bg-gray-100 rounded-xl p-6px"},[s(c,{size:14,icon:"ep:refresh"}),e[61]||(e[61]=d("\xA0 \u518D\u6B21\u63D0\u4EA4 "))])):w("",!0)]),s(Ia,{ref_key:"signRef",ref:pe,onSuccess:Je},null,512)],64)}}}),[["__scopeId","data-v-b54cf690"]]);export{Na as default};
