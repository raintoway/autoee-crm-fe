import{d as X,a as Z,z as ee,h as le,r as y,e as ae,bi as te,n as oe,U as se,o as i,c as m,f as l,w as t,u as o,N as A,x as p,F as w,p as h,q as f,O as re,D as E,y as S,t as z,a3 as ie,aq as ne,T as pe,C as ue,H as de,I as ce,A as me,B as fe,G as ye,dc as be,J as _e,K as we,d1 as ge,L as he,M as ve}from"./index-DPENBzsb.js";import{_ as xe}from"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import{_ as ke}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{_ as Ce}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{_ as Ve}from"./index-CbaPuDB3.js";import{d as F}from"./formatTime-C7TQtsxQ.js";import{h as Se,d as Te}from"./index-DetSWMsK.js";import{C as De}from"./index-C_gZe85y.js";import{a as Ue}from"./index-B9xqy6_R.js";import"./index-C2tU_CDa.js";import"./color-DXkOL5Tu.js";const Ne={key:0,class:"flex flex-col"},Pe=X({name:"BpmProcessInstanceMy",__name:"index",setup(Ie){const T=Z(),D=ee(),{t:U}=le(),v=y(!0),N=y(0),P=y([]),s=ae({pageNo:1,pageSize:10,name:"",processDefinitionKey:void 0,category:void 0,status:void 0,createTime:[]}),I=y(),x=y([]),b=async()=>{v.value=!0;try{const k=await Se(s);P.value=k.list,N.value=k.total}finally{v.value=!1}},g=y(!1),d=()=>{s.pageNo=1,b()},R=()=>{I.value.resetFields(),d()};return te(()=>{b()}),oe(async()=>{await b(),x.value=await De.getCategorySimpleList()}),(k,a)=>{const Y=Ve,B=pe,n=ue,K=de,u=ce,C=me,V=fe,H=ye,O=be,L=_e,M=Ce,c=we,G=ge,J=ke,W=he,$=xe,q=se("hasPermi"),j=ve;return i(),m(w,null,[l(Y,{title:"\u6D41\u7A0B\u53D1\u8D77\u3001\u53D6\u6D88\u3001\u91CD\u65B0\u53D1\u8D77",url:"https://doc.iocoder.cn/bpm/process-instance/"}),l(M,null,{default:t(()=>[l(L,{class:"-mb-15px",model:o(s),ref_key:"queryFormRef",ref:I,inline:!0,"label-width":"68px"},{default:t(()=>[l(n,{label:"",prop:"name"},{default:t(()=>[l(B,{modelValue:o(s).name,"onUpdate:modelValue":a[0]||(a[0]=e=>o(s).name=e),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u540D\u79F0",clearable:"",onKeyup:A(d,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(u,{onClick:d},{default:t(()=>[l(K,{icon:"ep:search",class:"mr-5px"}),a[10]||(a[10]=p(" \u641C\u7D22"))]),_:1})]),_:1}),l(n,{label:"",prop:"category",style:{position:"absolute",right:"300px"}},{default:t(()=>[l(V,{modelValue:o(s).category,"onUpdate:modelValue":a[1]||(a[1]=e=>o(s).category=e),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u5206\u7C7B",clearable:"",class:"!w-155px",onChange:d},{default:t(()=>[(i(!0),m(w,null,h(o(x),e=>(i(),f(C,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"",prop:"status",style:{position:"absolute",right:"130px"}},{default:t(()=>[l(V,{modelValue:o(s).status,"onUpdate:modelValue":a[2]||(a[2]=e=>o(s).status=e),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u72B6\u6001",clearable:"",class:"!w-155px",onChange:d},{default:t(()=>[(i(!0),m(w,null,h(o(re)(o(E).BPM_PROCESS_INSTANCE_STATUS),e=>(i(),f(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{style:{position:"absolute",right:"0px"}},{default:t(()=>[l(O,{visible:o(g),persistent:"",width:400,"show-arrow":!1,placement:"bottom-end"},{reference:t(()=>[l(u,{onClick:a[3]||(a[3]=e=>g.value=!o(g))},{default:t(()=>[l(K,{icon:"ep:plus",class:"mr-5px"}),a[11]||(a[11]=p("\u9AD8\u7EA7\u7B5B\u9009 "))]),_:1})]),default:t(()=>[l(n,{label:"\u6D41\u7A0B\u53D1\u8D77\u4EBA",class:"bold-label","label-position":"top",prop:"category"},{default:t(()=>[l(V,{modelValue:o(s).category,"onUpdate:modelValue":a[4]||(a[4]=e=>o(s).category=e),placeholder:"\u8BF7\u9009\u62E9\u6D41\u7A0B\u53D1\u8D77\u4EBA",clearable:"",class:"!w-390px"},{default:t(()=>[(i(!0),m(w,null,h(o(x),e=>(i(),f(C,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"\u6240\u5C5E\u6D41\u7A0B",class:"bold-label","label-position":"top",prop:"processDefinitionKey"},{default:t(()=>[l(B,{modelValue:o(s).processDefinitionKey,"onUpdate:modelValue":a[5]||(a[5]=e=>o(s).processDefinitionKey=e),placeholder:"\u8BF7\u8F93\u5165\u6D41\u7A0B\u5B9A\u4E49\u7684\u6807\u8BC6",clearable:"",onKeyup:A(d,["enter"]),class:"!w-390px"},null,8,["modelValue"])]),_:1}),l(n,{label:"\u53D1\u8D77\u65F6\u95F4",class:"bold-label","label-position":"top",prop:"createTime"},{default:t(()=>[l(H,{modelValue:o(s).createTime,"onUpdate:modelValue":a[6]||(a[6]=e=>o(s).createTime=e),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),l(n,{class:"bold-label","label-position":"top"},{default:t(()=>[l(u,{onClick:d},{default:t(()=>a[12]||(a[12]=[p(" \u786E\u8BA4")])),_:1}),l(u,{onClick:a[7]||(a[7]=e=>g.value=!1)},{default:t(()=>a[13]||(a[13]=[p(" \u53D6\u6D88")])),_:1}),l(u,{onClick:R},{default:t(()=>a[14]||(a[14]=[p(" \u6E05\u7A7A")])),_:1})]),_:1})]),_:1},8,["visible"])]),_:1})]),_:1},8,["model"])]),_:1}),l(M,null,{default:t(()=>[S((i(),f(W,{data:o(P)},{default:t(()=>[l(c,{label:"\u6D41\u7A0B\u540D\u79F0",align:"center",prop:"name","min-width":"200px",fixed:"left"}),l(c,{label:"\u6458\u8981",prop:"summary","min-width":"180",fixed:"left"},{default:t(e=>[e.row.summary&&e.row.summary.length>0?(i(),m("div",Ne,[(i(!0),m(w,null,h(e.row.summary,(_,r)=>(i(),m("div",{key:r},[l(G,{type:"info"},{default:t(()=>[p(z(_.key)+" : "+z(_.value),1)]),_:2},1024)]))),128))])):ie("",!0)]),_:1}),l(c,{label:"\u6D41\u7A0B\u5206\u7C7B",align:"center",prop:"categoryName","min-width":"100",fixed:"left"}),l(c,{label:"\u6D41\u7A0B\u72B6\u6001",prop:"status",width:"120"},{default:t(e=>[l(J,{type:o(E).BPM_PROCESS_INSTANCE_STATUS,value:e.row.status},null,8,["type","value"])]),_:1}),l(c,{label:"\u53D1\u8D77\u65F6\u95F4",align:"center",prop:"startTime",width:"180",formatter:o(F)},null,8,["formatter"]),l(c,{label:"\u7ED3\u675F\u65F6\u95F4",align:"center",prop:"endTime",width:"180",formatter:o(F)},null,8,["formatter"]),l(c,{label:"\u64CD\u4F5C",align:"center",fixed:"right",width:"180"},{default:t(e=>[S((i(),f(u,{link:"",type:"primary",onClick:_=>{return r=e.row,void T.push({name:"BpmProcessInstanceDetail",query:{id:r.id}});var r}},{default:t(()=>a[15]||(a[15]=[p(" \u8BE6\u60C5 ")])),_:2},1032,["onClick"])),[[q,["bpm:process-instance:cancel"]]]),e.row.status===1?S((i(),f(u,{key:0,link:"",type:"primary",onClick:_=>(async r=>{const{value:Q}=await ne.prompt("\u8BF7\u8F93\u5165\u53D6\u6D88\u539F\u56E0","\u53D6\u6D88\u6D41\u7A0B",{confirmButtonText:U("common.ok"),cancelButtonText:U("common.cancel"),inputPattern:/^[\s\S]*.*\S[\s\S]*$/,inputErrorMessage:"\u53D6\u6D88\u539F\u56E0\u4E0D\u80FD\u4E3A\u7A7A"});await Te(r.id,Q),D.success("\u53D6\u6D88\u6210\u529F"),await b()})(e.row)},{default:t(()=>a[16]||(a[16]=[p(" \u53D6\u6D88 ")])),_:2},1032,["onClick"])),[[q,["bpm:process-instance:query"]]]):(i(),f(u,{key:1,link:"",type:"primary",onClick:_=>(async r=>{if(r!=null&&r.id&&(await Ue(r.processDefinitionId)).formType===20)return void D.error("\u91CD\u65B0\u53D1\u8D77\u6D41\u7A0B\u5931\u8D25\uFF0C\u539F\u56E0\uFF1A\u8BE5\u6D41\u7A0B\u4F7F\u7528\u4E1A\u52A1\u8868\u5355\uFF0C\u4E0D\u652F\u6301\u91CD\u65B0\u53D1\u8D77");await T.push({name:"BpmProcessInstanceCreate",query:{processInstanceId:r==null?void 0:r.id}})})(e.row)},{default:t(()=>a[17]||(a[17]=[p(" \u91CD\u65B0\u53D1\u8D77 ")])),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])),[[j,o(v)]]),l($,{total:o(N),page:o(s).pageNo,"onUpdate:page":a[8]||(a[8]=e=>o(s).pageNo=e),limit:o(s).pageSize,"onUpdate:limit":a[9]||(a[9]=e=>o(s).pageSize=e),onPagination:b},null,8,["total","page","limit"])]),_:1})],64)}}});export{Pe as default};
