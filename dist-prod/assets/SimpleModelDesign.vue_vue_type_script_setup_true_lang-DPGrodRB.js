import{_ as K}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{d as R,r as s,ay as r,n as z,y as B,u as l,o as d,c as I,q as b,a3 as C,f as N,w as c,x as G,g as P,F as j,p as H,t as L,k as J,ba as Q,z as W,I as X,M as Y}from"./index-DPENBzsb.js";import{_ as Z}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{_ as $}from"./simple-process-designer-RJplQ98g.js";import{m as ee,N as h,n as q}from"./consts-Dqfik1EE.js";import{g as ae}from"./index-CmUERCts.js";import{g as se}from"./index-BOzeB1Pk.js";import{h as re}from"./tree-Cts6wVCK.js";import{g as oe}from"./index-tb7T-AVj.js";import{g as te}from"./index-BUzABQZW.js";import{g as le}from"./index-Btz8nVwe.js";import{g as me}from"./index-Co9HWb9O.js";import{g as ie}from"./index-BAEJzc7Z.js";import{B as de}from"./constants-C8tGWvl2.js";import"./el-drawer-DSddsvoD.js";import"./el-tree-select-DxCa0FGQ.js";import"./el-space-B67e9bQY.js";const ne={class:"overflow-auto"},ue=R({name:"SimpleProcessDesigner",__name:"SimpleProcessDesigner",props:{modelId:{type:String,required:!1},modelKey:{type:String,required:!1},modelName:{type:String,required:!1},startUserIds:{type:Array,required:!1}},emits:["success"],setup(S,{expose:f,emit:y}){const v=y,m=S,e=Q("processData"),n=s(!1),u=s([]),_=s(20),D=s([]),w=s([]),E=s([]),g=s([]),T=s(),k=s([]);r("formFields",u),r("formType",_),r("roleList",D),r("postList",w),r("userList",E),r("deptList",g),r("userGroupList",k),r("deptTree",T),r("startUserIds",m.startUserIds),r("tasks",[]),r("processInstance",{}),W();const t=s();r("processNodeTree",t);const p=s(!1);let x=[];const U=async o=>{if(o)try{e.value=o,v("success",o)}catch{}};z(async()=>{try{if(n.value=!0,m.modelId){const o=await ae(m.modelId);if(o&&(_.value=o.formType,_.value===de.NORMAL&&o.formId)){const a=await se(o.formId);u.value=a==null?void 0:a.fields}}D.value=await oe(),w.value=await le(),E.value=await me(),g.value=await te(),T.value=re(g.value,"id"),k.value=await ie(),e.value?t.value=e==null?void 0:e.value:t.value||(t.value={name:"\u53D1\u8D77\u4EBA",type:h.START_USER_NODE,id:q.START_USER_NODE_ID,childNode:{id:q.END_EVENT_NODE_ID,name:"\u7ED3\u675F",type:h.END_EVENT_NODE}},U(t.value))}finally{n.value=!1}});const M=s();return f({}),(o,a)=>{const O=X,V=Z,A=Y;return B((d(),I("div",ne,[l(t)?(d(),b($,{key:0,ref_key:"simpleProcessModelRef",ref:M,"flow-node":l(t),readonly:!1,onSave:U},null,8,["flow-node"])):C("",!0),N(V,{modelValue:l(p),"onUpdate:modelValue":a[1]||(a[1]=i=>J(p)?p.value=i:null),title:"\u4FDD\u5B58\u5931\u8D25",width:"400",fullscreen:!1},{footer:c(()=>[N(O,{type:"primary",onClick:a[0]||(a[0]=i=>p.value=!1)},{default:c(()=>a[2]||(a[2]=[G("\u77E5\u9053\u4E86")])),_:1})]),default:c(()=>[a[3]||(a[3]=P("div",{class:"mb-2"},"\u4EE5\u4E0B\u8282\u70B9\u5185\u5BB9\u4E0D\u5B8C\u5584\uFF0C\u8BF7\u4FEE\u6539\u540E\u4FDD\u5B58",-1)),(d(!0),I(j,null,H(l(x),(i,F)=>(d(),I("div",{class:"mb-3 b-rounded-1 bg-gray-100 p-2 line-height-normal",key:F},L(i.name)+" : "+L(l(ee).get(i.type)),1))),128))]),_:1},8,["modelValue"])])),[[A,l(n)]])}}}),pe=R({name:"SimpleModelDesign",__name:"SimpleModelDesign",props:{modelId:{},modelKey:{},modelName:{},startUserIds:{}},emits:["success"],setup(S,{emit:f}){const y=f,v=s(),m=e=>{e&&y("success",e)};return(e,n)=>{const u=K;return d(),b(u,{bodyStyle:{padding:"20px 16px"}},{default:c(()=>[N(l(ue),{"model-id":e.modelId,"model-key":e.modelKey,"model-name":e.modelName,onSuccess:m,"start-user-ids":e.startUserIds,ref_key:"designerRef",ref:v},null,8,["model-id","model-key","model-name","start-user-ids"])]),_:1})}}});export{pe as _};
