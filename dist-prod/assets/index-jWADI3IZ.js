import{d as re,z as ne,h as pe,r as d,e as ue,a as ie,aw as se,n as de,U as ce,o as p,c as C,f as e,w as o,u as l,N as G,F as x,p as I,O as M,D as c,q as i,x as s,y as b,k as me,t as H,T as fe,C as _e,A as be,B as we,H as ye,I as ve,J as ge,l as he,m as Ce,ad as xe,K as ke,L as Re,M as Se}from"./index-DPENBzsb.js";import{_ as Ue}from"./index.vue_vue_type_script_setup_true_lang-CvB_IkZW.js";import{_ as Ve}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{_ as Ne}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CnIlr_-B.js";import{_ as Te}from"./index-CbaPuDB3.js";import{d as k}from"./formatTime-C7TQtsxQ.js";import{d as Ee}from"./download-oWiM5xVU.js";import{e as Ie,n as Me,o as Oe}from"./index-OU-fIsLR.js";import{_ as Le}from"./CustomerForm.vue_vue_type_script_setup_true_lang-BDk16G-4.js";import{_ as De}from"./CustomerImportForm.vue_vue_type_script_setup_true_lang-NRVV1blW.js";import"./index-C2tU_CDa.js";import"./color-DXkOL5Tu.js";import"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import"./index-gTb5e5TR.js";import"./tree-Cts6wVCK.js";import"./index-Co9HWb9O.js";const Ae=re({name:"CrmCustomer",__name:"index",setup(Fe){const R=ne(),{t:Y}=pe(),S=d(!0),O=d(0),L=d([]),n=ue({pageNo:1,pageSize:10,sceneType:"1",name:"",mobile:"",industryId:void 0,level:void 0,source:void 0,pool:void 0}),D=d(),U=d(!1),V=d("1"),J=u=>{n.sceneType=u.paneName,w()},m=async()=>{S.value=!0;try{const u=await Ie(n);L.value=u.list,O.value=u.total}finally{S.value=!1}},w=()=>{n.pageNo=1,m()},j=()=>{D.value.resetFields(),w()},{currentRoute:Q,push:W}=ie(),A=d(),F=(u,t)=>{A.value.open(u,t)},z=d(),X=()=>{var u;(u=z.value)==null||u.open()},Z=async()=>{try{await R.exportConfirm(),U.value=!0;const u=await Oe(n);Ee.excel(u,"\u5BA2\u6237.xls")}catch{}finally{U.value=!1}};return se(()=>Q.value,()=>{m()}),de(()=>{m()}),(u,t)=>{const K=Te,q=fe,_=_e,N=be,T=we,y=ye,f=ve,$=ge,B=Ne,E=he,ee=Ce,ae=xe,r=ke,v=Ve,le=Re,te=Ue,g=ce("hasPermi"),oe=Se;return p(),C(x,null,[e(K,{title:"\u3010\u5BA2\u6237\u3011\u5BA2\u6237\u7BA1\u7406\u3001\u516C\u6D77\u5BA2\u6237",url:"https://doc.iocoder.cn/crm/customer/"}),e(K,{title:"\u3010\u901A\u7528\u3011\u6570\u636E\u6743\u9650",url:"https://doc.iocoder.cn/crm/permission/"}),e(B,null,{default:o(()=>[e($,{ref_key:"queryFormRef",ref:D,inline:!0,model:l(n),class:"-mb-15px","label-width":"68px"},{default:o(()=>[e(_,{label:"\u5BA2\u6237\u540D\u79F0",prop:"name"},{default:o(()=>[e(q,{modelValue:l(n).name,"onUpdate:modelValue":t[0]||(t[0]=a=>l(n).name=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u540D\u79F0",onKeyup:G(w,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"\u624B\u673A",prop:"mobile"},{default:o(()=>[e(q,{modelValue:l(n).mobile,"onUpdate:modelValue":t[1]||(t[1]=a=>l(n).mobile=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A",onKeyup:G(w,["enter"])},null,8,["modelValue"])]),_:1}),e(_,{label:"\u6240\u5C5E\u884C\u4E1A",prop:"industryId"},{default:o(()=>[e(T,{modelValue:l(n).industryId,"onUpdate:modelValue":t[2]||(t[2]=a=>l(n).industryId=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u884C\u4E1A"},{default:o(()=>[(p(!0),C(x,null,I(l(M)(l(c).CRM_CUSTOMER_INDUSTRY),a=>(p(),i(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u5BA2\u6237\u7EA7\u522B",prop:"level"},{default:o(()=>[e(T,{modelValue:l(n).level,"onUpdate:modelValue":t[3]||(t[3]=a=>l(n).level=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u7EA7\u522B"},{default:o(()=>[(p(!0),C(x,null,I(l(M)(l(c).CRM_CUSTOMER_LEVEL),a=>(p(),i(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"\u5BA2\u6237\u6765\u6E90",prop:"source"},{default:o(()=>[e(T,{modelValue:l(n).source,"onUpdate:modelValue":t[4]||(t[4]=a=>l(n).source=a),class:"!w-240px",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237\u6765\u6E90"},{default:o(()=>[(p(!0),C(x,null,I(l(M)(l(c).CRM_CUSTOMER_SOURCE),a=>(p(),i(N,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(_,null,{default:o(()=>[e(f,{onClick:w},{default:o(()=>[e(y,{class:"mr-5px",icon:"ep:search"}),t[9]||(t[9]=s(" \u641C\u7D22 "))]),_:1}),e(f,{onClick:j},{default:o(()=>[e(y,{class:"mr-5px",icon:"ep:refresh"}),t[10]||(t[10]=s(" \u91CD\u7F6E "))]),_:1}),b((p(),i(f,{type:"primary",onClick:t[5]||(t[5]=a=>F("create"))},{default:o(()=>[e(y,{class:"mr-5px",icon:"ep:plus"}),t[11]||(t[11]=s(" \u65B0\u589E "))]),_:1})),[[g,["crm:customer:create"]]]),b((p(),i(f,{plain:"",type:"warning",onClick:X},{default:o(()=>[e(y,{icon:"ep:upload"}),t[12]||(t[12]=s(" \u5BFC\u5165 "))]),_:1})),[[g,["crm:customer:import"]]]),b((p(),i(f,{loading:l(U),plain:"",type:"success",onClick:Z},{default:o(()=>[e(y,{class:"mr-5px",icon:"ep:download"}),t[13]||(t[13]=s(" \u5BFC\u51FA "))]),_:1},8,["loading"])),[[g,["crm:customer:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(B,null,{default:o(()=>[e(ee,{modelValue:l(V),"onUpdate:modelValue":t[6]||(t[6]=a=>me(V)?V.value=a:null),onTabClick:J},{default:o(()=>[e(E,{label:"\u6211\u8D1F\u8D23\u7684",name:"1"}),e(E,{label:"\u6211\u53C2\u4E0E\u7684",name:"2"}),e(E,{label:"\u4E0B\u5C5E\u8D1F\u8D23\u7684",name:"3"})]),_:1},8,["modelValue"]),b((p(),i(le,{data:l(L),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[e(r,{align:"center",fixed:"left",label:"\u5BA2\u6237\u540D\u79F0",prop:"name",width:"160"},{default:o(a=>[e(ae,{underline:!1,type:"primary",onClick:P=>{return h=a.row.id,void W({name:"CrmCustomerDetail",params:{id:h}});var h}},{default:o(()=>[s(H(a.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{align:"center",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",width:"100"},{default:o(a=>[e(v,{type:l(c).CRM_CUSTOMER_SOURCE,value:a.row.source},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u624B\u673A",prop:"mobile",width:"120"}),e(r,{align:"center",label:"\u7535\u8BDD",prop:"telephone",width:"130"}),e(r,{align:"center",label:"\u90AE\u7BB1",prop:"email",width:"180"}),e(r,{align:"center",label:"\u5BA2\u6237\u7EA7\u522B",prop:"level",width:"135"},{default:o(a=>[e(v,{type:l(c).CRM_CUSTOMER_LEVEL,value:a.row.level},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u5BA2\u6237\u884C\u4E1A",prop:"industryId",width:"100"},{default:o(a=>[e(v,{type:l(c).CRM_CUSTOMER_INDUSTRY,value:a.row.industryId},null,8,["type","value"])]),_:1}),e(r,{formatter:l(k),align:"center",label:"\u4E0B\u6B21\u8054\u7CFB\u65F6\u95F4",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"\u5907\u6CE8",prop:"remark",width:"200"}),e(r,{align:"center",label:"\u9501\u5B9A\u72B6\u6001",prop:"lockStatus"},{default:o(a=>[e(v,{type:l(c).INFRA_BOOLEAN_STRING,value:a.row.lockStatus},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u6210\u4EA4\u72B6\u6001",prop:"dealStatus"},{default:o(a=>[e(v,{type:l(c).INFRA_BOOLEAN_STRING,value:a.row.dealStatus},null,8,["type","value"])]),_:1}),e(r,{formatter:l(k),align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u65F6\u95F4",prop:"contactLastTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"\u6700\u540E\u8DDF\u8FDB\u8BB0\u5F55",prop:"contactLastContent",width:"200"}),e(r,{align:"center",label:"\u5730\u5740",prop:"detailAddress",width:"180"}),e(r,{align:"center",label:"\u8DDD\u79BB\u8FDB\u5165\u516C\u6D77\u5929\u6570",prop:"poolDay",width:"140"},{default:o(a=>[s(H(a.row.poolDay)+" \u5929",1)]),_:1}),e(r,{align:"center",label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserName",width:"100px"}),e(r,{align:"center",label:"\u6240\u5C5E\u90E8\u95E8",prop:"ownerUserDeptName",width:"100px"}),e(r,{formatter:l(k),align:"center",label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(r,{formatter:l(k),align:"center",label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"\u521B\u5EFA\u4EBA",prop:"creatorName",width:"100px"}),e(r,{align:"center",fixed:"right",label:"\u64CD\u4F5C","min-width":"150"},{default:o(a=>[b((p(),i(f,{link:"",type:"primary",onClick:P=>F("update",a.row.id)},{default:o(()=>t[14]||(t[14]=[s(" \u7F16\u8F91 ")])),_:2},1032,["onClick"])),[[g,["crm:customer:update"]]]),b((p(),i(f,{link:"",type:"danger",onClick:P=>(async h=>{try{await R.delConfirm(),await Me(h),R.success(Y("common.delSuccess")),await m()}catch{}})(a.row.id)},{default:o(()=>t[15]||(t[15]=[s(" \u5220\u9664 ")])),_:2},1032,["onClick"])),[[g,["crm:customer:delete"]]])]),_:1})]),_:1},8,["data"])),[[oe,l(S)]]),e(te,{limit:l(n).pageSize,"onUpdate:limit":t[7]||(t[7]=a=>l(n).pageSize=a),page:l(n).pageNo,"onUpdate:page":t[8]||(t[8]=a=>l(n).pageNo=a),total:l(O),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(Le,{ref_key:"formRef",ref:A,onSuccess:m},null,512),e(De,{ref_key:"importFormRef",ref:z,onSuccess:m},null,512)],64)}}});export{Ae as default};
