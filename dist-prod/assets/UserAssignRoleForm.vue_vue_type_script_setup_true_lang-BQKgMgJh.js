import{d as R,h as S,z as j,r,o as i,q as f,w as u,f as o,u as s,x as y,y as q,c as z,F as B,p as D,k as E,T as J,C as M,A as T,B as G,J as H,I as K,M as L}from"./index-DPENBzsb.js";import{_ as N}from"./Dialog.vue_vue_type_style_index_0_lang-ncKgepny.js";import{c as O,d as P}from"./index-COAxjvEa.js";import{g as Q}from"./index-tb7T-AVj.js";const W=R({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(X,{expose:V,emit:k}){const{t:b}=S(),I=j(),m=r(!1),n=r(!1),e=r({id:-1,nickname:"",username:"",roleIds:[]}),t=r(),v=r([]);V({open:async d=>{m.value=!0,h(),e.value.id=d.id,e.value.username=d.username,e.value.nickname=d.nickname,n.value=!0;try{e.value.roleIds=await O(d.id)}finally{n.value=!1}v.value=await Q()}});const w=k,U=async()=>{if(t&&await t.value.validate()){n.value=!0;try{await P({userId:e.value.id,roleIds:e.value.roleIds}),I.success(b("common.updateSuccess")),m.value=!1,w("success",!0)}finally{n.value=!1}}},h=()=>{var d;e.value={id:-1,nickname:"",username:"",roleIds:[]},(d=t.value)==null||d.resetFields()};return(d,l)=>{const p=J,c=M,x=T,F=G,g=H,_=K,A=N,C=L;return i(),f(A,{modelValue:s(m),"onUpdate:modelValue":l[4]||(l[4]=a=>E(m)?m.value=a:null),title:"\u5206\u914D\u89D2\u8272"},{footer:u(()=>[o(_,{disabled:s(n),type:"primary",onClick:U},{default:u(()=>l[5]||(l[5]=[y("\u786E \u5B9A")])),_:1},8,["disabled"]),o(_,{onClick:l[3]||(l[3]=a=>m.value=!1)},{default:u(()=>l[6]||(l[6]=[y("\u53D6 \u6D88")])),_:1})]),default:u(()=>[q((i(),f(g,{ref_key:"formRef",ref:t,model:s(e),"label-width":"80px"},{default:u(()=>[o(c,{label:"\u7528\u6237\u540D\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).username,"onUpdate:modelValue":l[0]||(l[0]=a=>s(e).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u7528\u6237\u6635\u79F0"},{default:u(()=>[o(p,{modelValue:s(e).nickname,"onUpdate:modelValue":l[1]||(l[1]=a=>s(e).nickname=a),disabled:!0},null,8,["modelValue"])]),_:1}),o(c,{label:"\u89D2\u8272"},{default:u(()=>[o(F,{modelValue:s(e).roleIds,"onUpdate:modelValue":l[2]||(l[2]=a=>s(e).roleIds=a),multiple:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:u(()=>[(i(!0),z(B,null,D(s(v),a=>(i(),f(x,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[C,s(n)]])]),_:1},8,["modelValue"])}}});export{W as _};
