import{dO as b,d as x,r as g,e as F,n as O,o as v,c as P,f as e,w as n,u as i,y as R,q as L,D as _,F as q,j as E,K as M,L as S,M as j,dz as B,dT as D}from"./index-DPENBzsb.js";import{_ as W}from"./DictTag.vue_vue_type_script_lang-pTU0zhE7.js";import{E as Y}from"./el-skeleton-item-ByHOrDfP.js";import{_ as z}from"./Echart.vue_vue_type_script_setup_true_lang-BK9hPyJ9.js";import{S as A}from"./customer-iWdjcsWp.js";const I=x({name:"CustomerFollowupType",__name:"CustomerFollowUpType",props:{queryParams:{}},setup(h,{expose:U}){const C=h,p=g(!1),w=g([]),s=F({title:{text:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790",left:"center"},legend:{orient:"vertical",left:"left"},tooltip:{trigger:"item",formatter:"{b} : {c}% "},toolbox:{feature:{saveAsImage:{show:!0,name:"\u5BA2\u6237\u8DDF\u8FDB\u65B9\u5F0F\u5206\u6790"}}},series:[{name:"\u8DDF\u8FDB\u65B9\u5F0F",type:"pie",radius:"50%",data:[],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),T=async()=>{const d=await A.getFollowUpSummaryByType(C.queryParams);s.series&&s.series[0]&&s.series[0].data&&(s.series[0].data=d.map(a=>({name:B(_.CRM_FOLLOW_UP_TYPE,a.followUpType),value:a.followUpRecordCount})));const y=(m="followUpRecordCount",(l=d)&&l.length?function(a,o){for(var t,u=-1,f=a.length;++u<f;){var r=o(a[u]);r!==void 0&&(t=t===void 0?r:t+r)}return t}(l,b(m)):0);var l,m;w.value=d.map(a=>({...a,portion:D(a.followUpRecordCount,y)}))},c=async()=>{p.value=!0;try{await T()}finally{p.value=!1}};return U({loadData:c}),O(()=>{c()}),(d,y)=>{const l=z,m=Y,a=E,o=M,t=W,u=S,f=j;return v(),P(q,null,[e(a,{shadow:"never"},{default:n(()=>[e(m,{loading:i(p),animated:""},{default:n(()=>[e(l,{height:500,options:i(s)},null,8,["options"])]),_:1},8,["loading"])]),_:1}),e(a,{shadow:"never",class:"mt-16px"},{default:n(()=>[R((v(),L(u,{data:i(w)},{default:n(()=>[e(o,{label:"\u5E8F\u53F7",align:"center",type:"index",width:"80"}),e(o,{label:"\u8DDF\u8FDB\u65B9\u5F0F",align:"center",prop:"followUpType","min-width":"200"},{default:n(r=>[e(t,{type:i(_).CRM_FOLLOW_UP_TYPE,value:r.row.followUpType},null,8,["type","value"])]),_:1}),e(o,{label:"\u4E2A\u6570",align:"center",prop:"followUpRecordCount","min-width":"200"}),e(o,{label:"\u5360\u6BD4(%)",align:"center",prop:"portion","min-width":"200"})]),_:1},8,["data"])),[[f,i(p)]])]),_:1})],64)}}});export{I as _};
